"use strict";(self.webpackChunkreact_arcgis=self.webpackChunkreact_arcgis||[]).push([[9634,2078],{62078:function(e,r,t){t.r(r),t.d(r,{addOrUpdateResource:function(){return l},contentToBlob:function(){return w},fetchResources:function(){return i},getSiblingOfSameType:function(){return b},getSiblingOfSameTypeI:function(){return k},removeAllResources:function(){return v},removeResource:function(){return h},splitPrefixFileNameAndExtension:function(){return x}});var n=t(74165),a=t(29439),s=t(15861),o=t(76200),u=t(10064),c=t(35995);function i(e){return p.apply(this,arguments)}function p(){return p=(0,s.Z)((0,n.Z)().mark((function e(r){var t,a,s,o,u,i,p,l,f,h,d,v,m=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.length>1&&void 0!==m[1]?m[1]:{},a=m.length>2?m[2]:void 0,e.next=4,r.load(a);case 4:return s=(0,c.v_)(r.itemUrl,"resources"),o=t.start,u=void 0===o?1:o,i=t.num,p=void 0===i?10:i,l=t.sortOrder,f=void 0===l?"asc":l,h=t.sortField,d={query:{start:u,num:p,sortOrder:f,sortField:void 0===h?"created":h,token:r.apiKey},signal:null===a||void 0===a?void 0:a.signal},e.next=16,r.portal.request(s,d);case 16:return v=e.sent,e.abrupt("return",{total:v.total,nextStart:v.nextStart,resources:v.resources.map((function(e){var t=e.created,n=e.size,a=e.resource;return{created:new Date(t),size:n,resource:r.resourceFromPath(a)}}))});case 18:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function l(e,r,t,n){return f.apply(this,arguments)}function f(){return f=(0,s.Z)((0,n.Z)().mark((function e(r,t,s,o){var i,p,l,f,h,d,v,m;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.hasPath()){e.next=2;break}throw new u.Z("portal-item-resource-".concat(t,":invalid-path"),"Resource does not have a valid path");case 2:return i=r.portalItem,e.next=5,i.load(o);case 5:return p=(0,c.v_)(i.userItemUrl,"add"===t?"addResources":"updateResources"),l=Z(r.path),f=(0,a.Z)(l,2),h=f[0],d=f[1],e.next=12,w(s);case 12:return v=e.sent,m=new FormData,h&&"."!==h&&m.append("resourcesPrefix",h),null!=o&&o.compress&&m.append("compress","true"),m.append("fileName",d),m.append("file",v,d),m.append("f","json"),null!=o&&o.access&&m.append("access",o.access),e.next=22,i.portal.request(p,{method:"post",body:m,signal:null===o||void 0===o?void 0:o.signal});case 22:return e.abrupt("return",r);case 23:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function h(e,r,t){return d.apply(this,arguments)}function d(){return d=(0,s.Z)((0,n.Z)().mark((function e(r,t,a){var s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.hasPath()){e.next=2;break}throw new u.Z("portal-item-resources-remove:invalid-path","Resource does not have a valid path");case 2:return e.next=4,r.load(a);case 4:return s=(0,c.v_)(r.userItemUrl,"removeResources"),e.next=7,r.portal.request(s,{method:"post",query:{resource:t.path},signal:null===a||void 0===a?void 0:a.signal});case 7:t.portalItem=null;case 8:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function v(e,r){return m.apply(this,arguments)}function m(){return(m=(0,s.Z)((0,n.Z)().mark((function e(r,t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.load(t);case 2:return a=(0,c.v_)(r.userItemUrl,"removeResources"),e.abrupt("return",r.portal.request(a,{method:"post",query:{deleteAll:!0},signal:null===t||void 0===t?void 0:t.signal}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){var r=e.lastIndexOf("/");return-1===r?[".",e]:[e.slice(0,r),e.slice(r+1)]}function x(e){var r=function(e){var r=(0,c.Ml)(e);return null==r?[e,""]:[e.slice(0,e.length-r.length-1),".".concat(r)]}(e),t=(0,a.Z)(r,2),n=t[0],s=t[1],o=Z(n),u=(0,a.Z)(o,2);return[u[0],u[1],s]}function w(e){return y.apply(this,arguments)}function y(){return(y=(0,s.Z)((0,n.Z)().mark((function e(r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r instanceof Blob)){e.next=2;break}return e.abrupt("return",r);case 2:return e.next=4,(0,o.default)(r.url,{responseType:"blob"});case 4:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,r){if(!e.hasPath())return null;var t=x(e.path),n=(0,a.Z)(t,3),s=n[0],o=n[2];return e.portalItem.resourceFromPath((0,c.v_)(s,r+o))}function k(e,r){if(!e.hasPath())return null;var t=x(e.path),n=(0,a.Z)(t,3),s=n[0],o=n[2];return e.portalItem.resourceFromPath((0,c.v_)(s,r+o))}},9634:function(e,r,t){t.r(r),t.d(r,{saveResources:function(){return f}});var n=t(1413),a=t(74165),s=t(37762),o=t(15861),u=t(14921),c=t(10064),i=t(66978),p=t(71907),l=t(62078);function f(e,r,t){return h.apply(this,arguments)}function h(){return h=(0,o.Z)((0,a.Z)().mark((function e(r,t,n){var o,u,f,h,v,Z,x,w,y,b,k,g,I,R,S,P,q;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.resources){e.next=2;break}return e.abrupt("return");case 2:o=t.portalItem===r.portalItem?new Set(r.paths):new Set,r.paths.length=0,r.portalItem=t.portalItem,u=new Set(t.resources.toKeep.map((function(e){return e.resource.path}))),f=new Set,h=[],u.forEach((function(e){o.delete(e),r.paths.push(e)})),v=(0,s.Z)(t.resources.toUpdate);try{for(v.s();!(Z=v.n()).done;)x=Z.value,o.delete(x.resource.path),u.has(x.resource.path)||f.has(x.resource.path)?(w=x.resource,y=x.content,b=x.finish,k=x.error,g=(0,l.getSiblingOfSameTypeI)(w,(0,p.D)()),r.paths.push(g.path),h.push(d({resource:g,content:y,compress:x.compress,finish:b,error:k},n))):(r.paths.push(x.resource.path),h.push(m(x,n)),f.add(x.resource.path))}catch(a){v.e(a)}finally{v.f()}I=(0,s.Z)(t.resources.toAdd);try{for(I.s();!(R=I.n()).done;)S=R.value,h.push(d(S,n)),r.paths.push(S.resource.path)}catch(a){I.e(a)}finally{I.f()}if(o.forEach((function(e){if(t.portalItem){var r=t.portalItem.resourceFromPath(e);h.push(r.portalItem.removeResource(r).catch((function(){})))}})),0!==h.length){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,(0,i.as)(h);case 14:if(P=e.sent,(0,i.k_)(n),q=P.filter((function(e){return"error"in e})).map((function(e){return e.error})),!(q.length>0)){e.next=19;break}throw new c.Z("save:resources","Failed to save one or more resources",{errors:q});case 19:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function d(e,r){return v.apply(this,arguments)}function v(){return(v=(0,o.Z)((0,a.Z)().mark((function e(r,t){var s,o,c,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=(0,n.Z)((0,n.Z)({},null!=t?t:{}),{},{compress:r.compress}),e.next=3,(0,u.q6)(r.resource.portalItem.addResource(r.resource,r.content,c));case 3:if(!0===(i=e.sent).ok){e.next=6;break}throw null!==(s=r.error)&&void 0!==s&&s.call(r,i.error),i.error;case 6:null===(o=r.finish)||void 0===o||o.call(r,r.resource);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,r){return Z.apply(this,arguments)}function Z(){return(Z=(0,o.Z)((0,a.Z)().mark((function e(r,t){var n,s,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.q6)(r.resource.update(r.content,t));case 2:if(!0===(o=e.sent).ok){e.next=5;break}throw null!==(n=r.error)&&void 0!==n&&n.call(r,o.error),o.error;case 5:null===(s=r.finish)||void 0===s||s.call(r,r.resource);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=9634.9f107660.chunk.js.map