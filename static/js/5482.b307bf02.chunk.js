"use strict";(self.webpackChunkreact=self.webpackChunkreact||[]).push([[5482],{35482:function(r,e,t){t.r(e),t.d(e,{default:function(){return M}});var a=t(37762),n=t(15671),o=t(43144),l=t(63780),u=t(18722),i=t(48976),f=t(4582),s=t(11186),c=t(8229),v=t(52587),b=t(78952),d=(t(93169),t(21134)),h=t(89431),p=t(87005),y=t(28278),m=t(2821);function g(r,e,t){return null!=r&&r.attributeInfo.useElevation?e?function(r,e){for(var t=new Float64Array(e),a=0;a<e;a++)t[a]=r[3*a+2];return t}(e,t):null:null!=r&&r.attributeInfo.storageInfo?(0,y.qM)(r.attributeInfo.storageInfo,r.buffer,t):null}function I(r,e,t,n,o){for(var l=r.length/3,u=0,i=0;i<l;i++){for(var f=!0,s=0;s<n.length&&f;s++){var c=n[s].filterJSON,v=o[s].values[i];switch(c.type){case"pointCloudValueFilter":var b="exclude"===c.mode;c.values.includes(v)===b&&(f=!1);break;case"pointCloudBitfieldFilter":var d=w(c.requiredSetBits),h=w(c.requiredClearBits);(v&d)===d&&0==(v&h)||(f=!1);break;case"pointCloudReturnFilter":var p,y=15&v,m=v>>>4&15,g=m>1,I=1===y,A=y===m,S=!1,k=(0,a.Z)(c.includedReturns);try{for(k.s();!(p=k.n()).done;){var M=p.value;if("last"===M&&A||"firstOfMany"===M&&I&&g||"lastOfMany"===M&&A&&g||"single"===M&&!g){S=!0;break}}}catch(C){k.e(C)}finally{k.f()}S||(f=!1)}}f&&(t[u]=i,r[3*u]=r[3*i],r[3*u+1]=r[3*i+1],r[3*u+2]=r[3*i+2],e[3*u]=e[3*i],e[3*u+1]=e[3*i+1],e[3*u+2]=e[3*i+2],u++)}return u}function A(r){switch(r){default:case null:case"none":return function(r){return r};case"low-four-bit":return function(r){return 15&r};case"high-four-bit":return function(r){return(240&r)>>4};case"absolute-value":return function(r){return Math.abs(r)};case"modulo-ten":return function(r){return r%10}}}function w(r){var e,t=0,n=(0,a.Z)(r||[]);try{for(n.s();!(e=n.n()).done;){t|=1<<e.value}}catch(o){n.e(o)}finally{n.f()}return t}var S=function(){function r(){(0,n.Z)(this,r)}return(0,o.Z)(r,[{key:"transform",value:function(r){var e=this._transform(r),t=[e.points.buffer,e.rgb.buffer];null!=e.pointIdFilterMap&&t.push(e.pointIdFilterMap.buffer);var n,o=(0,a.Z)(e.attributes);try{for(o.s();!(n=o.n()).done;){var l=n.value;"buffer"in l.values&&(0,u.eP)(l.values.buffer)&&l.values.buffer!==e.rgb.buffer&&t.push(l.values.buffer)}}catch(i){o.e(i)}finally{o.f()}return Promise.resolve({result:e,transferList:t})}},{key:"_transform",value:function(r){var e=function(r,e){if(null==r.encoding||""===r.encoding){var t=(0,y.W7)(e,r);if(null==t.vertexAttributes.position)return;for(var a=(0,y.I_)(e,t.vertexAttributes.position),n=t.header.fields,o=[n.offsetX,n.offsetY,n.offsetZ],l=[n.scaleX,n.scaleY,n.scaleZ],u=a.length/3,i=new Float64Array(3*u),f=0;f<u;f++)i[3*f]=a[3*f]*l[0]+o[0],i[3*f+1]=a[3*f+1]*l[1]+o[1],i[3*f+2]=a[3*f+2]*l[2]+o[2];return i}if("lepcc-xyz"===r.encoding)return(0,m.Gi)(e).result}(r.schema,r.geometryBuffer),t=e.length/3,n=null,o=new Array,u=g(r.primaryAttributeData,e,t);null!=r.primaryAttributeData&&u&&o.push({attributeInfo:r.primaryAttributeData.attributeInfo,values:u});var i=g(r.modulationAttributeData,e,t);null!=r.modulationAttributeData&&i&&o.push({attributeInfo:r.modulationAttributeData.attributeInfo,values:i});var f=function(r,e,t,a){var n=r.rendererJSON,o=r.isRGBRenderer,l=null,u=null;if(e&&o)l=e;else if(e&&"pointCloudUniqueValueRenderer"===(null===n||void 0===n?void 0:n.type)){var i=(u=p.Z.fromJSON(n)).colorUniqueValueInfos;l=new Uint8Array(3*a);for(var f=A(u.fieldTransformType),s=0;s<a;s++)for(var c=(f?f(e[s]):e[s])+"",v=0;v<i.length;v++)if(i[v].values.includes(c)){l[3*s]=i[v].color.r,l[3*s+1]=i[v].color.g,l[3*s+2]=i[v].color.b;break}}else if(e&&"pointCloudStretchRenderer"===(null===n||void 0===n?void 0:n.type)){var b=(u=h.Z.fromJSON(n)).stops;l=new Uint8Array(3*a);for(var y=A(u.fieldTransformType),m=0;m<a;m++){var g=y?y(e[m]):e[m],I=b.length-1;if(g<b[0].value)l[3*m]=b[0].color.r,l[3*m+1]=b[0].color.g,l[3*m+2]=b[0].color.b;else if(g>=b[I].value)l[3*m]=b[I].color.r,l[3*m+1]=b[I].color.g,l[3*m+2]=b[I].color.b;else for(var w=1;w<b.length;w++)if(g<b[w].value){var S=(g-b[w-1].value)/(b[w].value-b[w-1].value);l[3*m]=b[w].color.r*S+b[w-1].color.r*(1-S),l[3*m+1]=b[w].color.g*S+b[w-1].color.g*(1-S),l[3*m+2]=b[w].color.b*S+b[w-1].color.b*(1-S);break}}}else if(e&&"pointCloudClassBreaksRenderer"===(null===n||void 0===n?void 0:n.type)){var k=(u=d.Z.fromJSON(n)).colorClassBreakInfos;l=new Uint8Array(3*a);for(var M=A(u.fieldTransformType),C=0;C<a;C++)for(var Z=M?M(e[C]):e[C],O=0;O<k.length;O++)if(Z>=k[O].minValue&&Z<=k[O].maxValue){l[3*C]=k[O].color.r,l[3*C+1]=k[O].color.g,l[3*C+2]=k[O].color.b;break}}else l=new Uint8Array(3*a).fill(255);if(t&&u&&u.colorModulation)for(var x=u.colorModulation.minValue,D=u.colorModulation.maxValue,F=0;F<a;F++){var R=t[F],B=R>=D?1:R<=x?.3:.3+.7*(R-x)/(D-x);l[3*F]=B*l[3*F],l[3*F+1]=B*l[3*F+1],l[3*F+2]=B*l[3*F+2]}return l}(r.rendererInfo,u,i,t);if(r.filterInfo&&r.filterInfo.length>0&&null!=r.filterAttributesData){var s=r.filterAttributesData.filter(l.pC).map((function(r){var a=g(r,e,t),n={attributeInfo:r.attributeInfo,values:a};return o.push(n),n}));n=new Uint32Array(t),t=I(e,f,n,r.filterInfo,s)}var c,v=(0,a.Z)(r.userAttributesData);try{for(v.s();!(c=v.n()).done;){var w=c.value,S=g(w,e,t);o.push({attributeInfo:w.attributeInfo,values:S})}}catch(M){v.e(M)}finally{v.f()}3*t<f.length&&(f=new Uint8Array(f.buffer.slice(0,3*t))),this._applyElevationOffsetInPlace(e,t,r.elevationOffset);var k=this._transformCoordinates(e,t,r.obb,b.Z.fromJSON(r.inSR),b.Z.fromJSON(r.outSR));return{obb:r.obb,points:k,rgb:f,attributes:o,pointIdFilterMap:n}}},{key:"_transformCoordinates",value:function(r,e,t,a,n){if(!(0,v.projectBuffer)(r,a,0,r,n,0,e))throw new Error("Can't reproject");var o=(0,c.f)(t.center[0],t.center[1],t.center[2]),l=(0,c.c)(),u=(0,c.c)();(0,i.c)(k,t.quaternion);for(var f=new Float32Array(3*e),b=0;b<e;b++)l[0]=r[3*b]-o[0],l[1]=r[3*b+1]-o[1],l[2]=r[3*b+2]-o[2],(0,s.q)(u,l,k),t.halfSize[0]=Math.max(t.halfSize[0],Math.abs(u[0])),t.halfSize[1]=Math.max(t.halfSize[1],Math.abs(u[1])),t.halfSize[2]=Math.max(t.halfSize[2],Math.abs(u[2])),f[3*b]=l[0],f[3*b+1]=l[1],f[3*b+2]=l[2];return f}},{key:"_applyElevationOffsetInPlace",value:function(r,e,t){if(0!==t)for(var a=0;a<e;a++)r[3*a+2]+=t}}]),r}(),k=(0,f.c)();function M(){return new S}}}]);
//# sourceMappingURL=5482.b307bf02.chunk.js.map