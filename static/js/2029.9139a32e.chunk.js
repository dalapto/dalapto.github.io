"use strict";(self.webpackChunkreact=self.webpackChunkreact||[]).push([[2029],{44070:function(e,t,i){i.d(t,{f:function(){return g}});var r=i(74165),n=i(15861),s=i(15671),h=i(43144),u=i(63780),a=i(32718),o=i(92026),f=i(18722),l=i(37825),c=i(83826),_=i(8548),d=a.Z.getLogger("esri.views.webgl.BufferObject"),g=function(){function e(t,i,r,n){(0,s.Z)(this,e),this._context=t,this.bufferType=i,this.usage=r,this._glName=null,this._size=-1,this._indexType=void 0,t.instanceCounter.increment(_._g.BufferObject,this),this._glName=this._context.gl.createBuffer(),(0,l.zu)(this._context.gl),n&&this.setData(n)}return(0,h.Z)(e,[{key:"glName",get:function(){return this._glName}},{key:"size",get:function(){return this._size}},{key:"indexType",get:function(){return this._indexType}},{key:"byteLength",get:function(){return this.bufferType===_.w0.ELEMENT_ARRAY_BUFFER?this._indexType===_.g.UNSIGNED_INT?4*this._size:2*this._size:this._size}},{key:"_isVAOAware",get:function(){return this.bufferType===_.w0.ELEMENT_ARRAY_BUFFER||this.bufferType===_.w0.ARRAY_BUFFER}},{key:"dispose",value:function(){var e;null!==(e=this._context)&&void 0!==e&&e.gl?(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(_._g.BufferObject,this),this._context=(0,o.wN)(this._context)):this._glName&&d.warn("Leaked WebGL buffer object")}},{key:"setSize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e<=0&&d.error("Buffer size needs to be positive!"),this.bufferType===_.w0.ELEMENT_ARRAY_BUFFER&&null!=t)switch(this._indexType=t,t){case _.g.UNSIGNED_SHORT:e*=2;break;case _.g.UNSIGNED_INT:e*=4}this._setBufferData(e)}},{key:"setData",value:function(e){if(e){var t=e.byteLength;this.bufferType===_.w0.ELEMENT_ARRAY_BUFFER&&((0,f.Uc)(e)&&(t/=2,this._indexType=_.g.UNSIGNED_SHORT),(0,f.ZY)(e)&&(t/=4,this._indexType=_.g.UNSIGNED_INT)),this._setBufferData(t,e)}}},{key:"_setBufferData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._size=e;var i=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);var r=this._context.gl;null!=t?r.bufferData(this.bufferType,t,this.usage):r.bufferData(this.bufferType,e,this.usage),(0,l.zu)(r),this._isVAOAware&&this._context.bindVAO(i)}},{key:"setSubData",value:function(e,t,i,r){if(e){(t<0||t*e.BYTES_PER_ELEMENT>=this.byteLength)&&d.error("offset is out of range!"),i>=r&&d.error("end must be bigger than start!"),(t+(r-i))*e.BYTES_PER_ELEMENT>this.byteLength&&d.error("An attempt to write beyond the end of the buffer!");var n=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);var s=this._context.gl;if(this._context.type===c.zO.WEBGL2)s.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,e,i,r-i);else{var h=0===i&&r===e.length?e:e.subarray(i,r);s.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,h)}(0,l.zu)(s),this._isVAOAware&&this._context.bindVAO(n)}}},{key:"getSubData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(this._context.type===c.zO.WEBGL2)if(i<0||r<0)d.error("Problem getting subdata: offset and length were less than zero!");else{var n=function(e){return(0,u.zG)(e)}(e)?e.BYTES_PER_ELEMENT:1;if(n*((null!==i&&void 0!==i?i:0)+(null!==r&&void 0!==r?r:0))>e.byteLength)d.error("Problem getting subdata: offset and length exceeded destination size!");else{t+n*(null!==r&&void 0!==r?r:0)>this.byteLength&&d.warn("Potential problem getting subdata: requested data exceeds buffer size!");var s=this._context.gl;this._context.bindBuffer(this,_.w0.COPY_READ_BUFFER),s.getBufferSubData(_.w0.COPY_READ_BUFFER,t,e,i,r),this._context.unbindBuffer(_.w0.COPY_READ_BUFFER)}}else d.error("Get buffer subdata is supported in WebGL2 only!")}},{key:"getSubDataAsync",value:function(){var e=(0,n.Z)((0,r.Z)().mark((function e(t){var i,n,s,h=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=h.length>1&&void 0!==h[1]?h[1]:0,n=h.length>2?h[2]:void 0,s=h.length>3?h[3]:void 0,this._context.type!==c.zO.WEBGL2){e.next=9;break}return e.next=6,this._context.clientWaitAsync();case 6:this.getSubData(t,i,n,s),e.next=10;break;case 9:d.error("Get buffer subdata is supported in WebGL2 only!");case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"createIndex",value:function(t,i,r){return new e(t,_.w0.ELEMENT_ARRAY_BUFFER,i,r)}},{key:"createVertex",value:function(t,i,r){return new e(t,_.w0.ARRAY_BUFFER,i,r)}},{key:"createUniform",value:function(t,i,r){if(t.type!==c.zO.WEBGL2)throw new Error("Uniform buffers are supported in WebGL2 only!");return new e(t,_.w0.UNIFORM_BUFFER,i,r)}},{key:"createPixelPack",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_.l1.STREAM_READ,r=arguments.length>2?arguments[2]:void 0;if(t.type!==c.zO.WEBGL2)throw new Error("Pixel pack buffers are supported in WebGL2 only!");var n=new e(t,_.w0.PIXEL_PACK_BUFFER,i);return r&&n.setSize(r),n}},{key:"createPixelUnpack",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_.l1.STREAM_DRAW,r=arguments.length>2?arguments[2]:void 0;if(t.type!==c.zO.WEBGL2)throw new Error("Pixel unpack buffers are supported in WebGL2 only!");return new e(t,_.w0.PIXEL_UNPACK_BUFFER,i,r)}}]),e}()},53634:function(e,t,i){i.d(t,{X:function(){return E}});var r=i(74165),n=i(15861),s=i(29439),h=i(93433),u=i(15671),a=i(43144),o=(i(93169),i(32718)),f=i(92026),l=i(44070),c=i(37825),_=i(83826),d=i(8548),g=i(46888),T=i(15880),x=i(57808),b=o.Z.getLogger("esri.views.webgl.FramebufferObject"),E=function(){function e(t,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,u.Z)(this,e),this._context=t,this._glName=null,this._colorAttachments=new Map,this._depthBuffer=null,this._stencilBuffer=null,this._depthStencilTexture=null,this._initialized=!1,t.instanceCounter.increment(d._g.FramebufferObject,this);var n=p(i)?i:new x.x(this._context,i);if(this._colorAttachments.set(d.VY.COLOR_ATTACHMENT0,n),this._validateTextureDescriptor(n.descriptor),this._validateColorAttachmentPoint(d.VY.COLOR_ATTACHMENT0),null!=r)if(function(e){return p(e)||null!=e&&"pixelFormat"in e}(r))this._context.capabilities.depthTexture||console.error("Setting the depth/stencil texture as an attachment requires WEBGL_depth_texture or WebGL2"),this._depthStencilTexture=p(r)?r:new x.x(this._context,r),this._validateTextureDescriptor(this._depthStencilTexture.descriptor);else{var s=function(e){return null!=e&&"type"in e&&e.type===g.B.RenderBuffer}(r)?r:new T.r(this._context,r),h=s.descriptor;h.internalFormat===d.Tg.STENCIL_INDEX8?this._stencilBuffer=s:this._depthBuffer=s,this._validateRenderBufferDescriptor(h)}}return(0,a.Z)(e,[{key:"dispose",value:function(){var e,t,i=this;if(0!==this._colorAttachments.size||this._glName){var r=this._context.getBoundFramebufferObject();this._colorAttachments.forEach((function(e,t){var r;return null===(r=i.detachColorTexture(t))||void 0===r?void 0:r.dispose()})),null!==(e=this.detachDepthStencilBuffer())&&void 0!==e&&e.dispose(),null!==(t=this.detachDepthStencilTexture())&&void 0!==t&&t.dispose(),this._glName&&(this._context.gl.deleteFramebuffer(this._glName),this._glName=null),this._context.bindFramebuffer(r),this._context.instanceCounter.decrement(d._g.FramebufferObject,this)}}},{key:"glName",get:function(){return this._glName}},{key:"colorTexture",get:function(){return this._colorAttachments.get(d.VY.COLOR_ATTACHMENT0)}},{key:"depthStencilAttachment",get:function(){return this._depthStencilTexture||this._depthBuffer||this._stencilBuffer}},{key:"depthStencilTexture",get:function(){return this._depthStencilTexture}},{key:"width",get:function(){var e,t,i=this._colorAttachments.get(d.VY.COLOR_ATTACHMENT0);return null!==(e=null===i||void 0===i||null===(t=i.descriptor)||void 0===t?void 0:t.width)&&void 0!==e?e:0}},{key:"height",get:function(){var e,t,i=this._colorAttachments.get(d.VY.COLOR_ATTACHMENT0);return null!==(e=null===i||void 0===i||null===(t=i.descriptor)||void 0===t?void 0:t.height)&&void 0!==e?e:0}},{key:"gpuMemoryUsage",get:function(){var e,t;return(0,h.Z)(this._colorAttachments).reduce((function(e,t){var i=(0,s.Z)(t,2);i[0];return e+i[1].gpuMemoryUsage}),null!==(e=null===(t=this.depthStencilAttachment)||void 0===t?void 0:t.gpuMemoryUsage)&&void 0!==e?e:0)}},{key:"getColorTexture",value:function(e){var t=this._colorAttachments.get(e);return t&&p(t)?t:null}},{key:"attachColorTexture",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.VY.COLOR_ATTACHMENT0;if(e){this._validateColorAttachmentPoint(i);var r=e.descriptor;this._validateTextureDescriptor(r),null!==(t=this.detachColorTexture(i))&&void 0!==t&&t.dispose(),this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(e.glName,i)),this._colorAttachments.set(i,e)}}},{key:"detachColorTexture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.VY.COLOR_ATTACHMENT0,t=this._colorAttachments.get(e);if(t)return this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,e)),this._colorAttachments.delete(e),t}},{key:"setColorTextureTarget",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.VY.COLOR_ATTACHMENT0,i=this._colorAttachments.get(t);i&&this._framebufferTexture2D(i.glName,t,e)}},{key:"attachDepthStencil",value:function(e){if(e)switch(e.type){case g.B.Texture:return this._attachDepthStencilTexture(e);case g.B.RenderBuffer:return this._attachDepthStencilBuffer(e)}}},{key:"_attachDepthStencilTexture",value:function(e){var t;if(null!=e){var i=e.descriptor;i.pixelFormat!==d.VI.DEPTH_STENCIL&&i.pixelFormat!==d.VI.DEPTH24_STENCIL8&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!"),i.dataType!==d.Br.UNSIGNED_INT_24_8&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8!"),this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!"),this._validateTextureDescriptor(i),this._disposeDepthStencilAttachments(),this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(e.glName,d.Lu)),null!==(t=this._depthStencilTexture)&&void 0!==t&&t.dispose(),this._depthStencilTexture=e}}},{key:"detachDepthStencilTexture",value:function(){var e=this._depthStencilTexture;return e&&this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,d.Lu)),this._depthStencilTexture=null,e}},{key:"_attachDepthStencilBuffer",value:function(e){var t;if(null!=e){var i=e.descriptor;if(i.internalFormat!==d.Tg.DEPTH_STENCIL&&i.internalFormat!==d.Tg.DEPTH_COMPONENT16&&console.error("Depth/Stencil buffer must have correct internalFormat"),this._validateRenderBufferDescriptor(i),this._disposeDepthStencilAttachments(),this._initialized){this._context.bindFramebuffer(this);var r=this._context.gl,n=this._getGLAttachmentPoint(i);r.framebufferRenderbuffer(d.qi.FRAMEBUFFER,n,r.RENDERBUFFER,e.glName)}null!==(t=this._depthBuffer)&&void 0!==t&&t.dispose(),this._depthBuffer=e}}},{key:"detachDepthStencilBuffer",value:function(){var e=this._depthBuffer;if(e&&this._initialized){this._context.bindFramebuffer(this);var t=this._context.gl,i=this._getGLAttachmentPoint(e.descriptor);t.framebufferRenderbuffer(d.qi.FRAMEBUFFER,i,t.RENDERBUFFER,null),e.dispose()}return this._depthBuffer=null,e}},{key:"copyToTexture",value:function(e,t,i,r,n,s,h){(e<0||t<0||n<0||s<0)&&console.error("Offsets cannot be negative!"),(i<=0||r<=0)&&console.error("Copy width and height must be greater than zero!");var u=h.descriptor;h.descriptor.target!==d.No.TEXTURE_2D&&console.error("Texture target must be TEXTURE_2D!"),(null==(null===u||void 0===u?void 0:u.width)||null==(null===u||void 0===u?void 0:u.height)||e+i>this.width||t+r>this.height||n+i>u.width||s+r>u.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");var a=this._context,o=a.bindTexture(h,x.x.TEXTURE_UNIT_FOR_UPDATES);a.setActiveTexture(x.x.TEXTURE_UNIT_FOR_UPDATES),a.bindFramebuffer(this),a.gl.copyTexSubImage2D(d.No.TEXTURE_2D,0,n,s,e,t,i,r),a.bindTexture(o,x.x.TEXTURE_UNIT_FOR_UPDATES)}},{key:"readPixels",value:function(e,t,i,r,n,s,h){(i<=0||r<=0)&&console.error("Copy width and height must be greater than zero!"),h||console.error("Target memory is not initialized!"),this._context.bindFramebuffer(this),this._context.gl.readPixels(e,t,i,r,n,s,h)}},{key:"readPixelsAsync",value:function(){var e=(0,n.Z)((0,r.Z)().mark((function e(t,i,n,s,h,u,a){var o,f;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._context.type===_.zO.WEBGL2){e.next=2;break}return e.abrupt("return",((0,c.hZ)()&&console.warn("Attempting to read pixels using pixel buffer object without WebGL2"),void this.readPixels(t,i,n,s,h,u,a)));case 2:return o=this._context.gl,f=l.f.createPixelPack(this._context,d.l1.STREAM_READ,a.byteLength),this._context.bindBuffer(f),this._context.bindFramebuffer(this),o.readPixels(t,i,n,s,h,u,0),this._context.unbindBuffer(d.w0.PIXEL_PACK_BUFFER),e.next=9,f.getSubDataAsync(a);case 9:f.dispose();case 10:case"end":return e.stop()}}),e,this)})));return function(t,i,r,n,s,h,u){return e.apply(this,arguments)}}()},{key:"resize",value:function(e,t){var i,r,n;if(this.width!==e||this.height!==t){var s={width:e,height:t};v(s,this._context.parameters.maxTextureSize),this._colorAttachments.forEach((function(e){return e.resize(s.width,s.height)})),null!==(i=this._depthStencilTexture)&&void 0!==i&&i.resize(s.width,s.height),this._initialized&&(v(s,this._context.parameters.maxRenderbufferSize),null!==(r=this._depthBuffer)&&void 0!==r&&r.resize(s.width,s.height),null!==(n=this._stencilBuffer)&&void 0!==n&&n.resize(s.width,s.height),this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=!1)}}},{key:"initializeAndBind",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.qi.FRAMEBUFFER,i=this._context.gl;if(this._initialized)i.bindFramebuffer(t,this.glName);else{this._glName&&i.deleteFramebuffer(this._glName);var r=i.createFramebuffer();i.bindFramebuffer(t,r),this._colorAttachments.forEach((function(i,r){return e._framebufferTexture2D(i.glName,r,m(i),t)}));var n=this._depthBuffer||this._stencilBuffer;if(n){var s=this._getGLAttachmentPoint(n.descriptor);i.framebufferRenderbuffer(t,s,i.RENDERBUFFER,n.glName)}else this._depthStencilTexture&&this._framebufferTexture2D(this._depthStencilTexture.glName,i.DEPTH_STENCIL_ATTACHMENT,m(this._depthStencilTexture),t);(0,c.hZ)()&&i.checkFramebufferStatus(t)!==i.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!"),this._glName=r,this._initialized=!0}}},{key:"_framebufferTexture2D",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.VY.COLOR_ATTACHMENT0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d.No.TEXTURE_2D,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:d.qi.FRAMEBUFFER,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this._context.gl.framebufferTexture2D(r,t,i,e,n)}},{key:"_disposeDepthStencilAttachments",value:function(){var e=this._context.gl;if(this._depthBuffer){if(this._initialized){this._context.bindFramebuffer(this);var t=this._getGLAttachmentPoint(this._depthBuffer.descriptor);e.framebufferRenderbuffer(d.qi.FRAMEBUFFER,t,e.RENDERBUFFER,null)}this._depthBuffer=(0,f.M2)(this._depthBuffer)}this._stencilBuffer&&(this._initialized&&(this._context.bindFramebuffer(this),e.framebufferRenderbuffer(d.qi.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,null)),this._stencilBuffer=(0,f.M2)(this._stencilBuffer)),this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,e.DEPTH_STENCIL_ATTACHMENT)),this._depthStencilTexture=(0,f.M2)(this._depthStencilTexture))}},{key:"_validateTextureDescriptor",value:function(e){e.target!==d.No.TEXTURE_2D&&e.target!==d.No.TEXTURE_CUBE_MAP&&console.error("Texture type must be TEXTURE_2D or TEXTURE_CUBE_MAP!"),v(e,this._context.parameters.maxTextureSize),this._validateBufferDimensions(e)}},{key:"_validateRenderBufferDescriptor",value:function(e){v(e,this._context.parameters.maxRenderbufferSize),this._validateBufferDimensions(e)}},{key:"_validateBufferDimensions",value:function(e){e.width<=0&&(e.width=this.width),e.height<=0&&(e.height=this.height),this.width>0&&this.height>0&&(this.width===e.width&&this.height===e.height||console.error("Attachment size must match framebuffer size!"))}},{key:"_getGLAttachmentPoint",value:function(e){switch(e.internalFormat){case d.Tg.DEPTH_COMPONENT16:case d.Tg.DEPTH_COMPONENT24:case d.Tg.DEPTH_COMPONENT32F:return this._context.gl.DEPTH_ATTACHMENT;case d.Tg.DEPTH24_STENCIL8:case d.Tg.DEPTH32F_STENCIL8:case d.Tg.DEPTH_STENCIL:return this._context.gl.DEPTH_STENCIL_ATTACHMENT;case d.Tg.STENCIL_INDEX8:return this._context.gl.STENCIL_ATTACHMENT}}},{key:"_validateColorAttachmentPoint",value:function(t){if(-1===e._MAX_COLOR_ATTACHMENTS){var i=this._context.capabilities.drawBuffers;if(i){var r=this._context.gl;e._MAX_COLOR_ATTACHMENTS=r.getParameter(i.MAX_COLOR_ATTACHMENTS)}else e._MAX_COLOR_ATTACHMENTS=1}var n=t-d.VY.COLOR_ATTACHMENT0;n+1>e._MAX_COLOR_ATTACHMENTS&&o.Z.getLogger("esri.views.webgl.FrameBufferObject").error("esri.FrameBufferObject","illegal attachment point for color attachment: ".concat(n+1,". Implementation supports up to ").concat(e._MAX_COLOR_ATTACHMENTS," color attachments"))}}]),e}();function p(e){return null!=e&&"type"in e&&e.type===g.B.Texture}function v(e,t){var i=Math.max(e.width,e.height);if(i>t){b.warn("Resizing FBO attachment size ".concat(e.width,"x").concat(e.height," to device limit ").concat(t));var r=t/i;return e.width=Math.round(e.width*r),e.height=Math.round(e.height*r),!1}return!0}function m(e){return e.descriptor.target===d.No.TEXTURE_CUBE_MAP?d.No.TEXTURE_CUBE_MAP_POSITIVE_X:d.No.TEXTURE_2D}E._MAX_COLOR_ATTACHMENTS=-1},15880:function(e,t,i){i.d(t,{r:function(){return f}});var r=i(15671),n=i(43144),s=i(92026),h=i(83826),u=i(8548),a=i(46888),o=i(3479),f=function(){function e(t,i){(0,r.Z)(this,e),this._context=t,this._descriptor=i,this.type=a.B.RenderBuffer,this._context.instanceCounter.increment(u._g.Renderbuffer,this);var n=this._context.gl;this.glName=n.createRenderbuffer(),this._context.bindRenderbuffer(this);var s=i.width,o=i.height,f=i.internalFormat;if(i.multisampled){if(this._context.type!==h.zO.WEBGL2)throw new Error("Multisampled renderbuffers are not supported in WebGL1!");n.renderbufferStorageMultisample(n.RENDERBUFFER,this.samples,f,s,o)}else n.renderbufferStorage(n.RENDERBUFFER,f,s,o)}return(0,n.Z)(e,[{key:"descriptor",get:function(){return this._descriptor}},{key:"samples",get:function(){var e=this._descriptor.samples,t=this._context.parameters.maxSamples;return e?Math.min(e,t):t}},{key:"gpuMemoryUsage",get:function(){return(0,o.G)(this._descriptor)}},{key:"resize",value:function(e,t){var i=this._descriptor;if(i.width!==e||i.height!==t){i.width=e,i.height=t;var r=this._context.gl;this._context.bindRenderbuffer(this),i.multisampled?r.renderbufferStorageMultisample(r.RENDERBUFFER,this.samples,i.internalFormat,i.width,i.height):r.renderbufferStorage(r.RENDERBUFFER,i.internalFormat,i.width,i.height)}}},{key:"dispose",value:function(){this._context&&(this._context.gl.deleteRenderbuffer(this.glName),this._context.instanceCounter.decrement(u._g.Renderbuffer,this),this._context=(0,s.wN)(this._context))}}]),e}()},3479:function(e,t,i){i.d(t,{G:function(){return u},Y:function(){return h}});var r=i(43144),n=i(15671),s=i(3384),h=(0,r.Z)((function e(t,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i;(0,n.Z)(this,e),this.internalFormat=t,this.width=i,this.height=r,this.multisampled=!1,this.samples=1}));function u(e){return e.width<=0||e.height<=0||null==e.internalFormat?0:e.width*e.height*(0,s.RG)(e.internalFormat)}},45412:function(e,t,i){i.d(t,{U:function(){return l}});var r=i(15671),n=i(43144),s=i(32718),h=i(92026),u=i(18722),a=i(8548),o=i(3384),f=s.Z.getLogger("esri.views.webgl.VertexArrayObject"),l=function(){function e(t,i,n,s){var h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;(0,r.Z)(this,e),this._context=t,this._locations=i,this._layout=n,this._buffers=s,this._indexBuffer=h,this._glName=null,this._initialized=!1,t.instanceCounter.increment(a._g.VertexArrayObject,this)}return(0,n.Z)(e,[{key:"glName",get:function(){return this._glName}},{key:"context",get:function(){return this._context}},{key:"vertexBuffers",get:function(){return this._buffers}},{key:"indexBuffer",get:function(){return this._indexBuffer}},{key:"byteSize",get:function(){var e=this;return Object.keys(this._buffers).reduce((function(t,i){return t+e._buffers[i].byteLength}),null!=this._indexBuffer?this._indexBuffer.byteLength:0)}},{key:"layout",get:function(){return this._layout}},{key:"locations",get:function(){return this._locations}},{key:"memoryEstimate",get:function(){return this.byteSize+(Object.keys(this._buffers).length+(this._indexBuffer?1:0))*u.ru}},{key:"dispose",value:function(){if(this._context){for(var e in this._context.getBoundVAO()===this&&this._context.bindVAO(null),this._buffers){var t;null!==(t=this._buffers[e])&&void 0!==t&&t.dispose(),delete this._buffers[e]}this._indexBuffer=(0,h.M2)(this._indexBuffer),this.disposeVAOOnly()}else(this._glName||Object.getOwnPropertyNames(this._buffers).length>0)&&f.warn("Leaked WebGL VAO")}},{key:"disposeVAOOnly",value:function(){var e;this._glName&&((null===(e=this._context)||void 0===e||null===(e=e.capabilities)||void 0===e?void 0:e.vao).deleteVertexArray(this._glName),this._glName=null);this._context.instanceCounter.decrement(a._g.VertexArrayObject,this),this._context=(0,h.wN)(this._context)}},{key:"initialize",value:function(){if(!this._initialized){var e=this._context.capabilities.vao;if(e){var t=e.createVertexArray();e.bindVertexArray(t),this._bindLayout(),e.bindVertexArray(null),this._glName=t}this._initialized=!0}}},{key:"bind",value:function(){this.initialize();var e=this._context.capabilities.vao;e?e.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())}},{key:"_bindLayout",value:function(){var e=this._buffers,t=this._layout,i=this._indexBuffer;e||f.error("Vertex buffer dictionary is empty!");var r=this._context.gl;for(var n in e){var s=e[n];s||f.error("Vertex buffer is uninitialized!");var h=t[n];h||f.error("Vertex element descriptor is empty!"),(0,o.XP)(this._context,this._locations,s,h)}null!=i&&(this._context.capabilities.vao?r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,i.glName):this._context.bindBuffer(i))}},{key:"unbind",value:function(){this.initialize();var e=this._context.capabilities.vao;e?e.bindVertexArray(null):this._unbindLayout()}},{key:"_unbindLayout",value:function(){var e=this._buffers,t=this._layout;for(var i in e||f.error("Vertex buffer dictionary is empty!"),e){var r=e[i];r||f.error("Vertex buffer is uninitialized!");var n=t[i];(0,o.UF)(this._context,this._locations,r,n)}null!=this._indexBuffer&&this._context.unbindBuffer(this._indexBuffer.bufferType)}}]),e}()}}]);
//# sourceMappingURL=2029.9139a32e.chunk.js.map