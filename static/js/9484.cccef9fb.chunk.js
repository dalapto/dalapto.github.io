"use strict";(self.webpackChunkreact=self.webpackChunkreact||[]).push([[9484],{48035:function(e,t,r){r.d(t,{b:function(){return d},j:function(){return h}});var i=r(74165),n=r(15861),a=r(65905),s=r(93169),o=128e3,l=null,u=null;function h(){return c.apply(this,arguments)}function c(){return(c=(0,n.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(l||(l=f()),l));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return v.apply(this,arguments)}function v(){return v=(0,n.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,s.Z)("esri-csp-restrictions")){e.next=6;break}return e.next=3,r.e(5948).then(r.bind(r,5948)).then((function(e){return e.l}));case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,r.e(7069).then(r.bind(r,97069)).then((function(e){return e.l}));case 8:e.t0=e.sent;case 9:return t=e.t0,e.next=12,t.load({locateFile:function(e){return(0,a.V)("esri/core/libs/libtess/".concat(e))}});case 12:u=e.sent;case 13:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function d(e,t){var r=Math.max(e.length,o);return u.triangulate(e,t,r)}},8827:function(e,t,r){r.d(t,{i:function(){return s}});var i=r(15671),n=r(43144),a=r(71861),s=function(){function e(){(0,i.Z)(this,e)}return(0,n.Z)(e,null,[{key:"getPlacement",value:function(e,t,r,i,n,s){var o=(0,a.W)(r);return o?(-1===t&&e.invertY(),o.execute(e,r,i,n,s)):null}}]),e}()},82010:function(e,t,r){r.d(t,{z:function(){return y}});var i=r(15671),n=r(43144),a=r(48202),s=r(94109);function o(e,t){return e.x===t.x&&e.y===t.y}function l(e,t){return e.x=t.y,e.y=-t.x,e}function u(e,t){return e.x=-t.y,e.y=t.x,e}function h(e,t){return e.x=t.x,e.y=t.y,e}function c(e,t){return e.x=-t.x,e.y=-t.y,e}function f(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function v(e,t){return e.x*t.y-e.y*t.x}function d(e,t){return e.x*t.x+e.y*t.y}function _(e,t,r,i){return e.x=t.x*r+t.y*i,e.y=t.x*i-t.y*r,e}var y=function(){function e(t,r,n){(0,i.Z)(this,e),this._writeVertex=t,this._writeTriangle=r,this._canUseThinTessellation=n,this._prevNormal={x:void 0,y:void 0},this._nextNormal={x:void 0,y:void 0},this._textureNormalLeft={x:0,y:1},this._textureNormalRight={x:0,y:-1},this._textureNormal={x:void 0,y:void 0},this._joinNormal={x:void 0,y:void 0},this._inner={x:void 0,y:void 0},this._outer={x:void 0,y:void 0},this._roundStart={x:void 0,y:void 0},this._roundEnd={x:void 0,y:void 0},this._startBreak={x:void 0,y:void 0},this._endBreak={x:void 0,y:void 0},this._innerPrev={x:void 0,y:void 0},this._innerNext={x:void 0,y:void 0},this._bevelStart={x:void 0,y:void 0},this._bevelEnd={x:void 0,y:void 0},this._bevelMiddle={x:void 0,y:void 0}}return(0,n.Z)(e,[{key:"tessellate",value:function(e,t){(function(e){if(e){var t=e.length;if(!(t<=1)){for(var r=0,i=1;i<t;i++)o(e[i],e[r])||++r===i||(e[r]=e[i]);e.length=r+1}}})(e),this._canUseThinTessellation&&t.halfWidth<s.tQ&&!t.offset?this._tessellateThin(e,t):this._tessellate(e,t)}},{key:"_tessellateThin",value:function(e,t){if(!(e.length<2))for(var r=t.wrapDistance||65535,i=t.initialDistance||0,n=!1,a=e[0].x,s=e[0].y,o=e.length,l=1;l<o;++l){n&&(n=!1,i=0);var u=e[l].x,h=e[l].y,c=u-a,f=h-s,v=Math.sqrt(c*c+f*f);if(c/=v,f/=v,i+v>r){n=!0;var d=(r-i)/v;v=r-i,u=(1-d)*a+d*u,h=(1-d)*s+d*h,--l}var _=this._writeVertex(a,s,0,0,c,f,f,-c,0,-1,i),y=this._writeVertex(a,s,0,0,c,f,-f,c,0,1,i);i+=v;var x=this._writeVertex(u,h,0,0,c,f,f,-c,0,-1,i),p=this._writeVertex(u,h,0,0,c,f,-f,c,0,1,i);this._writeTriangle(_,y,x),this._writeTriangle(y,x,p),a=u,s=h}}},{key:"_tessellate",value:function(e,t){var r=e[0],i=e[e.length-1],n=o(r,i),s=n?3:2;if(!(e.length<s)){var y,x,p,m,g,k=t.pixelCoordRatio,w=null!=t.capType?t.capType:a.RL.BUTT,b=null!=t.joinType?t.joinType:a.AH.MITER,M=null!=t.miterLimit?Math.min(t.miterLimit,4):2,Z=null!=t.roundLimit?Math.min(t.roundLimit,1.05):1.05,L=null!=t.halfWidth?t.halfWidth:2,S=!!t.textured,T=null,z=this._prevNormal,W=this._nextNormal,P=-1,I=-1,C=this._joinNormal,F=this._textureNormalLeft,E=this._textureNormalRight,A=this._textureNormal,R=-1,B=-1,O=t.wrapDistance||65535,V=t.initialDistance||0,U=this._writeVertex,D=this._writeTriangle,G=function(e,t,r,i,n,a){var s=U(x,p,m,g,r,i,e,t,n,a,V);return R>=0&&B>=0&&s>=0&&D(R,B,s),R=B,B=s,s};n&&(y=e[e.length-2],W.x=i.x-y.x,W.y=i.y-y.y,I=f(W),W.x/=I,W.y/=I);for(var K=!1,N=0;N<e.length;++N){if(K&&(K=!1,V=0),y&&(z.x=-W.x,z.y=-W.y,V+(P=I)>O&&(K=!0)),K){var J=(O-V)/P;P=O-V,y={x:(1-J)*y.x+J*e[N].x,y:(1-J)*y.y+J*e[N].y},--N}else y=e[N];x=y.x,p=y.y;var X=N<=0&&!K,H=N===e.length-1;if(X||(V+=P),(T=H?n?e[1]:null:e[N+1])?(W.x=T.x-x,W.y=T.y-p,I=f(W),W.x/=I,W.y/=I):(W.x=void 0,W.y=void 0),!n){if(X){u(C,W),m=C.x,g=C.y,w===a.RL.SQUARE&&(G(-W.y-W.x,W.x-W.y,W.x,W.y,0,-1),G(W.y-W.x,-W.x-W.y,W.x,W.y,0,1)),w===a.RL.ROUND&&(G(-W.y-W.x,W.x-W.y,W.x,W.y,-1,-1),G(W.y-W.x,-W.x-W.y,W.x,W.y,-1,1)),w!==a.RL.ROUND&&w!==a.RL.BUTT||(G(-W.y,W.x,W.x,W.y,0,-1),G(W.y,-W.x,W.x,W.y,0,1));continue}if(H){l(C,z),m=C.x,g=C.y,w!==a.RL.ROUND&&w!==a.RL.BUTT||(G(z.y,-z.x,-z.x,-z.y,0,-1),G(-z.y,z.x,-z.x,-z.y,0,1)),w===a.RL.SQUARE&&(G(z.y-z.x,-z.x-z.y,-z.x,-z.y,0,-1),G(-z.y-z.x,z.x-z.y,-z.x,-z.y,0,1)),w===a.RL.ROUND&&(G(z.y-z.x,-z.x-z.y,-z.x,-z.y,1,-1),G(-z.y-z.x,z.x-z.y,-z.x,-z.y,1,1));continue}}var Y=void 0,q=void 0,j=-v(z,W);if(Math.abs(j)<.01)d(z,W)>0?(C.x=z.x,C.y=z.y,j=1,Y=Number.MAX_VALUE,q=!0):(u(C,W),j=1,Y=1,q=!1);else{C.x=(z.x+W.x)/j,C.y=(z.y+W.y)/j;var Q=((Y=f(C))-1)*L*k;q=Y>4||Q>P&&Q>I}m=C.x,g=C.y;var $=b;switch(b){case a.AH.BEVEL:Y<1.05&&($=a.AH.MITER);break;case a.AH.ROUND:Y<Z&&($=a.AH.MITER);break;case a.AH.MITER:Y>M&&($=a.AH.BEVEL)}switch($){case a.AH.MITER:if(G(C.x,C.y,-z.x,-z.y,0,-1),G(-C.x,-C.y,-z.x,-z.y,0,1),H)break;if(S){var ee=K?0:V;R=this._writeVertex(x,p,m,g,W.x,W.y,C.x,C.y,0,-1,ee),B=this._writeVertex(x,p,m,g,W.x,W.y,-C.x,-C.y,0,1,ee)}break;case a.AH.BEVEL:var te=j<0,re=void 0,ie=void 0,ne=void 0,ae=void 0;if(te){var se=R;R=B,B=se,re=F,ie=E}else re=E,ie=F;if(q)ne=te?u(this._innerPrev,z):l(this._innerPrev,z),ae=te?l(this._innerNext,W):u(this._innerNext,W);else{var oe=te?c(this._inner,C):h(this._inner,C);ne=oe,ae=oe}var le=te?l(this._bevelStart,z):u(this._bevelStart,z);G(ne.x,ne.y,-z.x,-z.y,re.x,re.y);var ue=G(le.x,le.y,-z.x,-z.y,ie.x,ie.y);if(H)break;var he=te?u(this._bevelEnd,W):l(this._bevelEnd,W);if(q){var ce=this._writeVertex(x,p,m,g,-z.x,-z.y,0,0,0,0,V);R=this._writeVertex(x,p,m,g,W.x,W.y,ae.x,ae.y,re.x,re.y,V),B=this._writeVertex(x,p,m,g,W.x,W.y,he.x,he.y,ie.x,ie.y,V),this._writeTriangle(ue,ce,B)}else{if(S){var fe=this._bevelMiddle;fe.x=(le.x+he.x)/2,fe.y=(le.y+he.y)/2,_(A,fe,-z.x,-z.y),G(fe.x,fe.y,-z.x,-z.y,A.x,A.y),_(A,fe,W.x,W.y),R=this._writeVertex(x,p,m,g,W.x,W.y,fe.x,fe.y,A.x,A.y,V),B=this._writeVertex(x,p,m,g,W.x,W.y,ae.x,ae.y,re.x,re.y,V)}else{var ve=R;R=B,B=ve}G(he.x,he.y,W.x,W.y,ie.x,ie.y)}if(te){var de=R;R=B,B=de}break;case a.AH.ROUND:var _e=j<0,ye=void 0,xe=void 0;if(_e){var pe=R;R=B,B=pe,ye=F,xe=E}else ye=E,xe=F;var me=_e?c(this._inner,C):h(this._inner,C),ge=void 0,ke=void 0;q?(ge=_e?u(this._innerPrev,z):l(this._innerPrev,z),ke=_e?l(this._innerNext,W):u(this._innerNext,W)):(ge=me,ke=me);var we=_e?l(this._roundStart,z):u(this._roundStart,z),be=_e?u(this._roundEnd,W):l(this._roundEnd,W),Me=G(ge.x,ge.y,-z.x,-z.y,ye.x,ye.y),Ze=G(we.x,we.y,-z.x,-z.y,xe.x,xe.y);if(H)break;var Le=this._writeVertex(x,p,m,g,-z.x,-z.y,0,0,0,0,V);q||this._writeTriangle(R,B,Le);var Se=c(this._outer,me),Te=this._writeVertex(x,p,m,g,W.x,W.y,be.x,be.y,xe.x,xe.y,V),ze=void 0,We=void 0,Pe=Y>2;if(Pe){var Ie=void 0;Y!==Number.MAX_VALUE?(Se.x/=Y,Se.y/=Y,Ie=(Y*((Ie=d(z,Se))*Ie-1)+1)/Ie):Ie=-1,(ze=_e?l(this._startBreak,z):u(this._startBreak,z)).x+=z.x*Ie,ze.y+=z.y*Ie,(We=_e?u(this._endBreak,W):l(this._endBreak,W)).x+=W.x*Ie,We.y+=W.y*Ie}_(A,Se,-z.x,-z.y);var Ce=this._writeVertex(x,p,m,g,-z.x,-z.y,Se.x,Se.y,A.x,A.y,V);_(A,Se,W.x,W.y);var Fe=S?this._writeVertex(x,p,m,g,W.x,W.y,Se.x,Se.y,A.x,A.y,V):Ce,Ee=Le,Ae=S?this._writeVertex(x,p,m,g,W.x,W.y,0,0,0,0,V):Le,Re=-1,Be=-1;if(Pe&&(_(A,ze,-z.x,-z.y),Re=this._writeVertex(x,p,m,g,-z.x,-z.y,ze.x,ze.y,A.x,A.y,V),_(A,We,W.x,W.y),Be=this._writeVertex(x,p,m,g,W.x,W.y,We.x,We.y,A.x,A.y,V)),S?Pe?(this._writeTriangle(Ee,Ze,Re),this._writeTriangle(Ee,Re,Ce),this._writeTriangle(Ae,Fe,Be),this._writeTriangle(Ae,Be,Te)):(this._writeTriangle(Ee,Ze,Ce),this._writeTriangle(Ae,Fe,Te)):Pe?(this._writeTriangle(Le,Ze,Re),this._writeTriangle(Le,Re,Be),this._writeTriangle(Le,Be,Te)):(this._writeTriangle(Le,Ze,Ce),this._writeTriangle(Le,Fe,Te)),q?(R=this._writeVertex(x,p,m,g,W.x,W.y,ke.x,ke.y,ye.x,ye.y,V),B=Te):(R=S?this._writeVertex(x,p,m,g,W.x,W.y,ke.x,ke.y,ye.x,ye.y,V):Me,this._writeTriangle(R,Ae,Te),B=Te),_e){var Oe=R;R=B,B=Oe}}}}}}]),e}()},72774:function(e,t,r){r.d(t,{_:function(){return m}});var i=r(4942),n=r(15671),a=r(43144),s=(r(5131),r(37995),r(73828)),o=(r(32344),r(85269),r(94109)),l=r(84328),u=r(80613),h=r(84319),c=new Map;function f(e,t,r){var i=c.get(e),n=i.indicesPerRecord,a=i.multiplier,s=i.verticesPerRecord;return{recordBytes:r*o.XJ*Uint32Array.BYTES_PER_ELEMENT,indexBytes:a*n*r*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:a*s*r*t}}c.set(u.LW.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4}),c.set(u.LW.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8}),c.set(u.LW.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10}),c.set(u.LW.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4}),c.set(u.LW.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});var v=r(27446),d=function(){function e(t,r,i){(0,n.Z)(this,e),this._start={index:0,vertex:0};var a=f(t,r,i),s=r/4;this.geometryType=t,this._records=new v.Z(Int32Array,a.recordBytes),this._indices=new v.Z(Uint32Array,a.indexBytes),this._vertices=new v.Z(Uint32Array,a.vertexBytes),this._metrics=new v.Z(Float32Array,0),this._strideInt=s}return(0,a.Z)(e,[{key:"serialize",value:function(e){var t=this._records.buffer(),r=this._indices.buffer(),i=this._vertices.buffer(),n=this._metrics.length?this._metrics.buffer():null,a=4*this._strideInt;return e.push(t,r,i),{stride:a,records:t,indices:r,vertices:i,metrics:n}}},{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/o.XJ}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}},{key:"vertexEnsureSize",value:function(e){this._vertices.ensureSize(e)}},{key:"indexEnsureSize",value:function(e){this._indices.ensureSize(e)}},{key:"recordStart",value:function(){this._start.index=this._indices.length,this._start.vertex=this._vertices.length}},{key:"recordEnd",value:function(e,t,r,i,n,a,s,o){this._records.push(e),this._records.push(null!==t&&void 0!==t?t:0),this._records.push(r),this._records.push(i),this._records.push(n),this._records.push(a),this._records.push(s),this._records.writeF32(o)}},{key:"writeIndex",value:function(e){this._indices.push(e)}},{key:"writeVertex",value:function(e){this._vertices.push(e)}},{key:"writeVertexF32",value:function(e){this._vertices.writeF32(e)}},{key:"copyLastFrom",value:function(e,t,r){for(var i=e._records.length-o.XJ,n=e._records.getValue(i),a=e._records.getValue(i+1),s=e._records.getValue(i+2),l=e._records.getValue(i+4),u=e._records.getValue(i+6),h=e._records.getValue(i+7),c=this._vertices.length,f=(e._start.vertex-this._vertices.length)/this._strideInt,v=this._indices.length,d=this.vertexCount,_=e._start.index;_!==e._indices.length;_++){var y=e._indices.getValue(_);this._indices.push(y-f)}for(var x=e._start.vertex;x!==e._vertices.length;x++){var p=e._vertices.getValue(x);this._vertices.push(p)}for(var m=c;m<=this._vertices.length;m+=this._strideInt)this._vertices.i1616Add(m,t,r);this._records.push(n),this._records.push(a),this._records.push(s),this._records.push(v),this._records.push(l),this._records.push(d),this._records.push(u),this._records.push(h)}}]),e}(),_=r(35092),y=128;function x(e){switch(e){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case y:return 1}}function p(e){switch(e){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case y:return 1}}var m=function(){function e(t,r,i,a,s){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;(0,n.Z)(this,e),this._hasAggregate=!1,this.hasRecords=!1,this._data={self:new Map,neighbors:new Array},this._version=0,this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0},this.hint=r,this.tileKey=t,this._hasAggregate=a,this._pixelBufferEnabled=s,this._version=o,this._symbologyType=i}return(0,a.Z)(e,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}},{key:"serialize",value:function(e){var t=this,r=[];return r.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self)),this._data.neighbors.forEach((function(i,n){var a=1<<n,o=x(a),l=p(a),u=(0,_.M)(new s.Z(t.tileKey),o,l,e),h=t._serializeTileVertexData(t.tileKey,u.id,i.vertexData);h.message.bufferIds=i.displayIds,r.push(h)})),r}},{key:"_serializeTileVertexData",value:function(e,t,r){var n,a,s,o,l,h,c=new Array;return{message:{tileKeyOrigin:e,tileKey:t,data:(h={},(0,i.Z)(h,u.LW.MARKER,null===(n=r.get(u.LW.MARKER))||void 0===n?void 0:n.serialize(c)),(0,i.Z)(h,u.LW.FILL,null===(a=r.get(u.LW.FILL))||void 0===a?void 0:a.serialize(c)),(0,i.Z)(h,u.LW.LINE,null===(s=r.get(u.LW.LINE))||void 0===s?void 0:s.serialize(c)),(0,i.Z)(h,u.LW.TEXT,null===(o=r.get(u.LW.TEXT))||void 0===o?void 0:o.serialize(c)),(0,i.Z)(h,u.LW.LABEL,null===(l=r.get(u.LW.LABEL))||void 0===l?void 0:l.serialize(c)),h),version:this._version},transferList:c}}},{key:"featureStart",value:function(e,t){this._current.insertAfter=e,this._current.sortKey=t}},{key:"featureEnd",value:function(){}},{key:"recordStart",value:function(e,t,r,i){this._current.writer=this._getVertexWriter(r),this._current.overlaps=0,this._current.indexStart=this._current.writer.indexCount,this._current.vertStart=this._current.writer.vertexCount,this._current.bufferingEnabled=i,this._current.id=e,this._current.materialKey=t,this._current.geometryType=r,this._current.isDotDensity=!1,this._current.writer.recordStart()}},{key:"recordCount",value:function(){return this._current.writer.recordCount}},{key:"vertexCount",value:function(){return this._current.writer.vertexCount}},{key:"indexCount",value:function(){return this._current.writer.indexCount}},{key:"vertexEnsureSize",value:function(e){this._current.writer.vertexEnsureSize(e)}},{key:"indexEnsureSize",value:function(e){this._current.writer.indexEnsureSize(e)}},{key:"vertexBounds",value:function(e,t,r,i){this._current.bufferingEnabled&&this._addOverlap(e,t,r,i)}},{key:"vertexWrite",value:function(e){this._current.writer.writeVertex(e)}},{key:"vertexWriteF32",value:function(e){this._current.writer.writeVertexF32(e)}},{key:"vertexEnd",value:function(){}},{key:"vertexWriter",value:function(){return this._current.writer.vertexWriter}},{key:"indexWrite",value:function(e){this._current.writer.writeIndex(e)}},{key:"indexWriter",value:function(){return this._current.writer.indexWriter}},{key:"metricWriter",value:function(){return this._current.writer.metricWriter}},{key:"metricStart",value:function(e,t,r,i,n,a,s,o){this._current.writer=this._getVertexWriter(u.LW.LABEL);var h=this._current.writer.metricWriter;h.push((0,l.jL)(e)),h.push(t),h.push(r),h.push(i),h.push(n),h.push(a),h.push(s),h.push(o),h.push(255),this._current.metricBoxLenPointer=h.push(0)}},{key:"metricEnd",value:function(){var e=this._current.writer.metricWriter;0===e.getValue(this._current.metricBoxLenPointer)&&e.seek(e.length-10)}},{key:"metricBoxWrite",value:function(e,t,r,i){var n=this._current.writer.metricWriter;n.incr(this._current.metricBoxLenPointer),n.push(0),n.push(0),n.push(e),n.push(t),n.push(r),n.push(i)}},{key:"recordEnd",value:function(){var e=this._current.vertStart,t=this._current.writer.vertexCount-e;if(!t)return!1;this.hasRecords=!0;var r=this._current.indexStart,i=this._current.writer.indexCount-r;if(this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,r,i,e,t,this._current.sortKey),!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===u.LW.LABEL)return!0;for(var n=this._current.writer,a=0;a<8;a++){var s=1<<a;if(this._current.overlaps&s){this._data.neighbors[a]||(this._data.neighbors[a]={vertexData:new Map,displayIds:new Set});var l=this._data.neighbors[a],c=this._current.geometryType;if(!l.vertexData.has(c)){var f=(0,h.$_)(c,this._symbologyType).geometry,v=new d(c,f,o.Ip);l.vertexData.set(c,v)}var _=l.vertexData.get(this._current.geometryType),y=512*-x(s)*8,m=512*-p(s)*8;null!==_&&void 0!==_&&_.copyLastFrom(n,y,m),l.displayIds.add(this._current.id)}}return!0}},{key:"_addOverlap",value:function(e,t,r,i){var n=255^((e<0+r?148:e>=o.I_-r?41:189)|(t<0+i?224:t>=o.I_-i?7:231));this._current.overlaps|=n}},{key:"_getVertexWriter",value:function(e){if(!this._data.self.has(e)){var t=this._data.self,r=(0,h.$_)(e,this._symbologyType).geometry;t.set(e,new d(e,r,this.hint.records))}return this._data.self.get(e)}}]),e}()},74017:function(e,t,r){r.d(t,{j:function(){return G}});var i=r(74165),n=r(15861),a=r(37762),s=r(15671),o=r(43144),l=(r(93169),r(66978)),u=r(48035),h=r(84328),c=r(29439),f=r(60136),v=r(29388),d=r(10064),_=r(32718),y=r(16889),x=r(17842),p=r(22018),m=r(11245),g=r(48202),k=r(38999),w=r(65800),b=r(94109),M=r(80613),Z=r(73271),L=r(54815),S=r(42093);function T(e){return e.length-1}function z(e){for(var t=0,r=0;r<T(e);r++)t+=W(e,r);return t}function W(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=function(e,t){return e[t+1]}(e,t),n=(0,c.Z)(i,2),a=n[0],s=n[1];return Math.sqrt(a*a+s*s)*r}var P=function(){function e(t,r,i,n,a){(0,s.Z)(this,e),this._segments=t,this._index=r,this._distance=i,this._xStart=n,this._yStart=a,this._done=!1}return(0,o.Z)(e,[{key:"clone",value:function(){return new e(this._segments,this._index,this._distance,this.xStart,this.yStart)}},{key:"equals",value:function(e){return this._index===e._index||e._index===this._index-1&&(0===this._distance||1===e._distance)||e._index===this._index+1&&(1===this._distance||0===e._distance)}},{key:"leq",value:function(e){return this._index<e._index||this._index===e._index&&this._distance<=e._distance}},{key:"geq",value:function(e){return this._index>e._index||this._index===e._index&&this._distance>=e._distance}},{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){var e=this.dy,t=(0*e+-1*-this.dx)/(1*this.length),r=Math.acos(t);return e>0&&(r=2*Math.PI-r),r}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){var e=this.dx,t=this.dy;return Math.sqrt(e*e+t*t)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}},{key:"hasPrev",value:function(){return this._index-1>=0}},{key:"hasNext",value:function(){return this._index+1<T(this._segments)}},{key:"next",value:function(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}},{key:"prev",value:function(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}},{key:"_seekBackwards",value:function(e,t){var r=this.backwardLength;if(e<=r)return this._distance=(r-e)/this.length,this;for(var i=this.backwardLength;this.prev();){if(i+this.length>e)return this._seekBackwards(e-i);i+=this.length}return this._distance=0,t?this:null}},{key:"seek",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e<0)return this._seekBackwards(Math.abs(e),t);if(e<=this.remainingLength)return this._distance=(this.backwardLength+e)/this.length,this;for(var r=this.remainingLength;this.next();){if(r+this.length>e)return this.seek(e-r,t);r+=this.length}return this._distance=1,t?this:null}}],[{key:"create",value:function(t){return new e(t,0,0,t[0][0],t[0][1])}}]),e}();function I(e,t,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=z(e),a=P.create(e),s=n/2;if(!i)return a.seek(s),void r(a.clone(),0,s+0*t,n);var o=Math.max((n-t)/2,0),l=Math.floor(o/t),u=s-l*t;a.seek(u);for(var h=-l;h<=l;h++)a.x<512&&a.x>=0&&a.y<512&&a.y>=0&&r(a.clone(),h,s+h*t,n),a.seek(t)}function C(e,t){var r=1e-6;if(!(t<=0)){var i=e.length;if(!(i<3)){var n=[],a=0;n.push(0);for(var s=1;s<i;s++)a+=(0,S.TK)(e[s],e[s-1]),n.push(a);t=Math.min(t,.2*a);var o=[];o.push(e[0][0]),o.push(e[0][1]);var l=e[i-1][0],u=e[i-1][1],h=(0,S.lu)([0,0],e[0],e[1]);(0,S.Fv)(h),e[0][0]+=t*h[0],e[0][1]+=t*h[1],(0,S.lu)(h,e[i-1],e[i-2]),(0,S.Fv)(h),e[i-1][0]+=t*h[0],e[i-1][1]+=t*h[1];for(var c=1;c<i;c++)n[c]+=t;n[i-1]+=t;for(var f=.5*t,v=1;v<i-1;v++){for(var d=0,_=0,y=0,x=v-1;x>=0&&!(n[x+1]<n[v]-f);x--){var p=f+n[x+1]-n[v],m=n[x+1]-n[x],g=n[v]-n[x]<f?1:p/m;if(Math.abs(g)<r)break;var k=g*g,w=g*p-.5*k*m,b=g*m/t,M=e[x+1],Z=e[x][0]-M[0],L=e[x][1]-M[1];d+=b/w*(M[0]*g*p+.5*k*(p*Z-m*M[0])-k*g*m*Z/3),_+=b/w*(M[1]*g*p+.5*k*(p*L-m*M[1])-k*g*m*L/3),y+=b}for(var T=v+1;T<i&&!(n[T-1]>n[v]+f);T++){var z=f-n[T-1]+n[v],W=n[T]-n[T-1],P=n[T]-n[v]<f?1:z/W;if(Math.abs(P)<r)break;var I=P*P,C=P*z-.5*I*W,F=P*W/t,E=e[T-1],A=e[T][0]-E[0],R=e[T][1]-E[1];d+=F/C*(E[0]*P*z+.5*I*(z*A-W*E[0])-I*P*W*A/3),_+=F/C*(E[1]*P*z+.5*I*(z*R-W*E[1])-I*P*W*R/3),y+=F}o.push(d/y),o.push(_/y)}o.push(l),o.push(u);for(var B=0,O=0;B<i;B++)e[B][0]=o[O++],e[B][1]=o[O++]}}}var F=r(27344),E=_.Z.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate");var A=function(e){var t=new Map;return function(r){return t.has(r)||t.set(r,e(r)),t.get(r)}}((function(e){var t=0;if(0===e)return 1/0;for(;!(e%2);)t++,e/=2;return t})),R=function(e){return Math.floor(127*e+127)},B=function(e){return Math.floor(10*e)},O=function(e){return Math.round(e*(254/360))},V=function(e){(0,f.Z)(r,e);var t=(0,v.Z)(r);function r(e,i,n,a){var o,l,u,h,f,v,d;(0,s.Z)(this,r),(d=t.call(this,e,null===(o=n.font)||void 0===o?void 0:o.size,n.haloSize||0,null===(l=n.font)||void 0===l?void 0:l.size,n.color&&(0,w.aH)(n.color)||0,n.haloColor&&(0,w.aH)(n.haloColor)||0,n.horizontalAlignment,n.verticalAlignment,(0,k.NS)(i.labelPlacement)?g.v2.MAP:g.v2.SCREEN,null===(u=n.font)||void 0===u?void 0:u.decoration,!1,n.angle||0,n.xoffset,n.yoffset,n.lineWidth,n.lineHeight,null,null,!1,null,null,n.backgroundColor&&(0,w.aH)(n.backgroundColor),n.borderLineColor&&(0,w.aH)(n.borderLineColor),n.borderLineSize))._outLineLabelAngle=0,d._refPlacementPadding=0,d._refPlacementDirX=0,d._refPlacementDirY=0,d._refOffsetX=0,d._refOffsetY=0,d._zoomLevel=0,d.geometryType=M.LW.LABEL,d._allowOverrun=null!==(h=i.allowOverrun)&&void 0!==h&&h,d._repeatLabel=null===(f=i.repeatLabel)||void 0===f||f,d._labelPosition=null!==(v=i.labelPosition)&&void 0!==v?v:"curved";var _=function(e,t){var r=!!e.minScale&&t.scaleToZoom(e.minScale)||0;return(0,y.uZ)(r,0,25.5)}(i,a),p=function(e,t){var r=!!e.maxScale&&t.scaleToZoom(e.maxScale)||255;return(0,y.uZ)(r,0,25.5)}(i,a),m=i.labelPlacement,Z=(0,k.qv)(m),S=(0,c.Z)(Z,2),T=S[0],z=S[1];d._xAlignD=T,d._yAlignD=z,d._minZoom=_,d._maxZoom=p,d._minBackgroundZoom=_,d._maxBackgroundZoom=p,d._refPlacementPadding=(0,x.F2)(n.haloSize)+b.Iw,d._repeatLabelDistance=i.repeatLabelDistance?(0,x.F2)(i.repeatLabelDistance):128;var W=L.Gq.load(e);return W.sdf=!0,d._materialKey=W.data,d}return(0,o.Z)(r,[{key:"_shapedBox",get:function(){return this._shapingInfo.bounds}},{key:"setZoomLevel",value:function(e){this._zoomLevel=e}},{key:"bindReferenceTemplate",value:function(e){var t=(0,k.g)(this._xAlignD),r=(0,k.tf)(this._yAlignD);if(this._refOffsetX=0,this._refOffsetY=0,null!=e){if("circle"===e.boundsType&&(t||r)){var i=Math.sqrt(t*t+r*r);t/=i,r/=i}var n=Math.max(e.height,e.width),a=4*this._refPlacementPadding;this._refSymbolAndPlacementOffset=(0,Z.Jz)(a,n,R(t),R(r)),this._referenceSize=n,this._refPlacementDirX=t,this._refPlacementDirY=r,this._refOffsetX=e.xOffset,this._refOffsetY=e.yOffset}else this._refSymbolAndPlacementOffset=(0,Z.Jz)(0,0,R(t),R(r))}},{key:"_write",value:function(e,t){if(null!=this._shapingInfo){var r=this._shapingInfo,i=t.getDisplayId(),n="esriGeometryPolygon"===t.geometryType?t.readLegacyCentroid():t.readLegacyGeometry();if(n)switch(this._current={out:e,inId:i,inShaping:r,zoomLevel:this._zoomLevel},"esriGeometryPolyline"===t.geometryType&&"curved"===this._labelPosition&&(this._borderLineColor||this._backgroundColor)&&E.warnOnce("TextSymbol properties 'borderLineColor', 'borderLineSize', and 'backgroundColor' are not supported in curved labels"),t.geometryType){case"esriGeometryPolyline":this._placeLineLabels(n);break;case"esriGeometryPoint":case"esriGeometryPolygon":this._placePointLabels(n);break;default:!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mapview-labeling";E.error(new d.Z(t,e))}("Geometry of type ".concat(t.geometryType," is not supported"))}}}},{key:"_isVisible",value:function(e,t){var r=B(this._current.zoomLevel);return B(e)<=r&&r<=B(t)}},{key:"_placePointLabels",value:function(e){var t=this._current,r=t.out,i=t.inId,n=t.inShaping;this._writeGlyphs(r,i,e,n)}},{key:"_placeLineLabels",value:function(e){var t,r=function(e,t){for(var r=t,i=0;i<e.length;i++){var n=e[i];C(n,r);var a=[];a.push(n[0]);for(var s=1;s<n.length;s++){var o=(0,c.Z)(n[s-1],2),l=o[0],u=o[1],h=(0,c.Z)(n[s],2),f=h[0],v=h[1],d=Math.round(f-l),_=Math.round(v-u);a.push([d,_])}e[i]=a,n=a}return e}(e.paths,this._current.inShaping.bounds.width),i=this._placeSubdivGlyphs.bind(this),n=(this._shapedBox.width+this._repeatLabelDistance)/2,s=(0,a.Z)(r);try{for(s.s();!(t=s.n()).done;){I(t.value,n,i,this._repeatLabel)}}catch(o){s.e(o)}finally{s.f()}}},{key:"_placeSubdivGlyphs",value:function(e,t,r,i){var n=A(t),a=this._shapedBox.width/2,s=Math.sqrt(this._repeatLabelDistance)/2,o=Math.min(r,i-r),l=this._current.inShaping.isMultiline?25:Math.log2(o/(s+a/2)),u=0===t?l:Math.min(n,l),h=Math.max(this._minZoom,this._current.zoomLevel+1-u),c=this._current.zoomLevel-h,f=this._shapedBox.width/2*Math.pow(2,c);this._current.inShaping.isMultiline?0===t&&this._placeStraight(e,h):this._allowOverrun&&c<0?this._placeStraightAlong(e,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(e,h):"curved"===this._labelPosition&&this._placeCurved(e,h,f)}},{key:"_placeStraight",value:function(e,t){var r=this._current,i=r.out,n=r.inId,a=r.inShaping,s=Math.ceil(e.angle*(180/Math.PI)%360),o=Math.ceil((e.angle*(180/Math.PI)+180)%360);this._outLineLabelAngle=O(s),this._writeGlyphs(i,n,e,a,t),this._outLineLabelAngle=O(o),this._writeGlyphs(i,n,e,a,t)}},{key:"_placeCurved",value:function(e,t,r){var i=this._current,n=i.out,a=i.inId;n.metricStart(a,t,e.x,e.y,0,0,0,0);var s=e.clone(),o=e.angle*(180/Math.PI)%360,l=(e.angle*(180/Math.PI)+180)%360;this._outLineLabelAngle=O(o),this._placeFirst(s,t,1),this._placeBack(e,s,t,r,1),this._placeForward(e,s,t,r,1),this._outLineLabelAngle=O(l),this._placeFirst(s,t,0),this._placeBack(e,s,t,r,0),this._placeForward(e,s,t,r,0),n.metricEnd()}},{key:"_placeStraightAlong",value:function(e,t){var r=this._current,i=r.out,n=r.inId,a=r.inShaping;i.metricStart(n,t,e.x,e.y,0,0,0,0);var s=e.clone(),o=e.angle*(180/Math.PI)%360,l=(e.angle*(180/Math.PI)+180)%360,u=a.glyphs.length>0&&(this._borderLineColor||this._backgroundColor);if(this._maxBackgroundZoom=25,this._minBackgroundZoom=Math.max(t,0),u){var h=L.Gq.load(this._materialKey);h.textureBinding=a.glyphs[0].textureBinding;var f=(0,p.b)((0,m.c)(),-e.angle),v=a.shapeBackground(f),d=(0,c.Z)(v,2),_=d[0],y=d[1];this._outLineLabelAngle=O(o),i.recordStart(n,h.data,this.geometryType,!0),this._writeBackgroundGeometry(i,n,e,_,y),i.recordEnd(),this._outLineLabelAngle=O(l),i.recordStart(n,h.data,this.geometryType,!0),this._writeBackgroundGeometry(i,n,e,_,y),i.recordEnd()}this._outLineLabelAngle=O(o),this._placeFirst(s,t,1,!0),this._outLineLabelAngle=O(l),this._placeFirst(s,t,0,!0),i.metricEnd()}},{key:"_placeBack",value:function(e,t,r,i,n){for(var a=e.clone(),s=e.backwardLength+0;a.prev()&&!(s>=i);)this._placeOnSegment(a,t,s,r,-1,n),s+=a.length+0}},{key:"_placeForward",value:function(e,t,r,i,n){for(var a=e.clone(),s=e.remainingLength+0;a.next()&&!(s>=i);)this._placeOnSegment(a,t,s,r,1,n),s+=a.length+0}},{key:"_placeFirst",value:function(e,t,r){var i,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=e,o=this._current.inShaping,l=o.glyphs,u=this._current.zoomLevel,h=this._current,c=h.out,f=h.inId,v=(0,a.Z)(l);try{for(v.s();!(i=v.n()).done;){var d=i.value,_=d.x>o.bounds.x?r:1-r,y=_*e.remainingLength+(1-_)*e.backwardLength,x=Math.abs(d.x+d.width/2-o.bounds.x),p=Math.max(0,u+Math.log2(x/(y+0))),m=Math.max(t,n?0:p);if(d.maxZoom=25,d.angle=e.angle+(1-r)*Math.PI,d.minZoom=m,this._writeGlyph(c,f,s.x,s.y,d),r&&this._isVisible(d.minZoom,d.maxZoom)){var g=d.bounds;c.metricBoxWrite(g.center[0],g.center[1],g.width,g.height)}}}catch(k){v.e(k)}finally{v.f()}}},{key:"_placeOnSegment",value:function(e,t,r,i,n,s){var o,l=this._current.inShaping.glyphs,u=this._current,h=u.out,c=u.inId,f=this._current.inShaping,v=this._current.zoomLevel,d=e.dx/e.length,_=e.dy/e.length,y={x:e.x+r*-n*d,y:e.y+r*-n*_},x=(0,a.Z)(l);try{for(x.s();!(o=x.n()).done;){var p=o.value,m=p.x>f.bounds.x?s:1-s;if(m&&1===n||!m&&-1===n){var g=Math.abs(p.x+p.width/2-f.bounds.x),k=Math.max(0,v+Math.log2(g/r)-.1),w=Math.max(i,v+Math.log2(g/(r+e.length+0)));if(0!==k&&(p.angle=e.angle+(1-s)*Math.PI,p.minZoom=w,p.maxZoom=k,this._writeGlyph(h,c,y.x,y.y,p),s&&this._isVisible(p.minZoom,p.maxZoom))){var b=p.bounds,M=e.x-t.x,Z=e.y-t.y;h.metricBoxWrite(b.center[0]+M,b.center[1]+Z,b.width,b.height)}}}}catch(L){x.e(L)}finally{x.f()}}},{key:"_writeGlyphs",value:function(e,t,r,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this._minZoom;if(!(r.x<0||r.x>=512||r.y<0||r.y>=512)){if(i.glyphs.length>0&&(this._borderLineColor||this._backgroundColor)){var s=L.Gq.load(this._materialKey);s.textureBinding=i.glyphs[0].textureBinding,e.recordStart(t,s.data,this.geometryType,!0),this._writeBackgroundGeometry(e,t,r,i.bounds,i.background),e.recordEnd()}var o,l=r.x+this._refOffsetX,u=r.y-this._refOffsetY,h=(0,a.Z)(i.glyphs);try{for(h.s();!(o=h.n()).done;){var c=o.value;c.minZoom=n,c.maxZoom=this._maxZoom,this._writeGlyph(e,t,l,u,c)}}catch(_){h.e(_)}finally{h.f()}var f=this._refPlacementDirX,v=this._refPlacementDirY,d=i.boundsT;e.metricStart(t,n,l,u,f,v,this._referenceSize,this._materialKey),e.metricBoxWrite(d.center[0],d.center[1],d.width,d.height),e.metricEnd()}}},{key:"_writeVertexCommon",value:function(e,t,r,i){var n=this._color,a=this._haloColor,s=(0,Z.Jz)(0,0,this._size,this._haloSize),o=Math.max(i.minZoom,this._minZoom),l=Math.min(i.maxZoom,this._maxZoom),u=(0,Z.Jz)(B(o),B(l),this._outLineLabelAngle,0);e.vertexWrite(r),e.vertexWrite(t),e.vertexWrite(n),e.vertexWrite(a),e.vertexWrite(s),e.vertexWrite(this._refSymbolAndPlacementOffset),e.vertexWrite(u)}},{key:"_writeBackgroundVertex",value:function(e,t,r,i,n,a){var s=(0,Z.Jz)(0,0,this._size,this._haloSize),o=(0,Z.Jz)(0,0,0,0),l=(0,Z.Jz)(B(this._minBackgroundZoom),B(this._maxBackgroundZoom),this._outLineLabelAngle,1);e.vertexWrite(r),e.vertexWrite(t),e.vertexWrite(i),e.vertexWrite(o),e.vertexWrite(s),e.vertexWrite(this._refSymbolAndPlacementOffset),e.vertexWrite(l),e.vertexWrite(n),e.vertexWrite(a),e.vertexEnd()}}],[{key:"fromLabelClass",value:function(e,t){if("esriServerLinePlacementCenterAlong"===e.labelPlacement){var i=e.symbol;i.xoffset=0,i.yoffset=0,i.angle=0,i.font.decoration="none"}return new r(e.materialKey,e,e.symbol,t)}}]),r}(F.Z),U=r(64580),D=r(61909),G=function(){function e(t,r,i){(0,s.Z)(this,e),this._loadPromise=(0,u.j)(),this._geometryType=t,this._idField=r,this._templateStore=i}return(0,o.Z)(e,[{key:"update",value:function(e,t){null!=e.mesh.labels&&(this._labelTemplates=this._createLabelTemplates(e.mesh.labels,t)),this._schema=e}},{key:"_createLabelTemplates",value:function(e,t){var r=new Map;if("simple"===e.type){var i,n=(0,a.Z)(e.classes);try{for(n.s();!(i=n.n()).done;){var s=i.value,o=V.fromLabelClass(s,t);r.set(s.index,o)}}catch(d){n.e(d)}finally{n.f()}return r}for(var l in e.classes){var u,h=e.classes[l],c=(0,a.Z)(h);try{for(c.s();!(u=c.n()).done;){var f=u.value,v=V.fromLabelClass(f,t);r.set(f.index,v)}}catch(d){c.e(d)}finally{c.f()}}return r}},{key:"templates",get:function(){return this._templateStore}},{key:"analyze",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t,r,n,s,o,u,c){var f,v,d,_,y,x,p;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,l.Hc)(c)){e.next=2;break}return e.abrupt("return");case 2:if(e.t0="dictionary"===(null===n||void 0===n?void 0:n.type),!e.t0){e.next=7;break}return e.next=6,n.analyze(this._idField,t.copy(),r,o,u,c);case 6:f=e.sent;case 7:for(v=0;t.next();)if(null,d=f?f[v++]:null!=s&&(0,h.nE)(t.getDisplayId())&&1!==t.readAttribute("cluster_count")?s.match(this._idField,t,this._geometryType,o,u):n.match(this._idField,t,this._geometryType,o,u),t.setGroupId(d),(0,D.Sl)(d)){_=this._templateStore.getDynamicTemplateGroup(d).templates,y=(0,a.Z)(_);try{for(y.s();!(x=y.n()).done;)(p=x.value)&&p.analyze&&p.analyze(this._templateStore,t,o,u)}catch(i){y.e(i)}finally{y.f()}}return e.next=11,this._loadPromise;case 11:return e.abrupt("return",this._templateStore.finalize(c));case 12:case"end":return e.stop()}}),e,this)})));return function(t,r,i,n,a,s,o){return e.apply(this,arguments)}}()},{key:"analyzeGraphics",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t,r,n,s,o,u){var h,c,f,v,d,_;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,l.Hc)(u)){e.next=2;break}return e.abrupt("return");case 2:if(h=t.getCursor(),e.t0=n,!e.t0){e.next=7;break}return e.next=7,n.analyze(this._idField,h.copy(),r,s,o,u);case 7:if(!h.next()){e.next=13;break}if(null!=(c=h.getGroupId())&&-1!==c||(c=null===n||void 0===n?void 0:n.match(this._idField,h,h.geometryType,s,o),h.setGroupId(c)),(0,D.Sl)(c)){f=this._templateStore.getDynamicTemplateGroup(c).templates,v=(0,a.Z)(f);try{for(v.s();!(d=v.n()).done;)(_=d.value)&&_.analyze&&_.analyze(this._templateStore,h,s,o)}catch(i){v.e(i)}finally{v.f()}}h.setGroupId(c);case 11:e.next=7;break;case 13:return e.next=15,this._loadPromise;case 15:return e.abrupt("return",this._templateStore.finalize(u));case 16:case"end":return e.stop()}}),e,this)})));return function(t,r,i,n,a,s){return e.apply(this,arguments)}}()},{key:"writeGraphic",value:function(e,t,r,i){var n=t.getGroupId(),s=t.getDisplayId(),o=this._templateStore.getTemplateGroup(n);if(e.featureStart(t.insertAfter,0),null!=s){if((0,D.Sl)(n)){var l,u=(0,a.Z)(o.templates);try{for(u.s();!(l=u.n()).done;){var h=l.value;h&&h.bindFeature(t,null,null)}}catch(d){u.e(d)}finally{u.f()}}if(o){var c,f=(0,a.Z)(o.templates);try{for(f.s();!(c=f.n()).done;){var v=c.value;v&&v.write(e,t,r,i)}}catch(d){f.e(d)}finally{f.f()}e.featureEnd()}}}},{key:"writeCursor",value:function(e,t,r,i,n,s,o){var l=t.getGroupId(),u=t.getDisplayId(),h=this._templateStore.getTemplateGroup(l),c=h.templates,f=this._getSortKeyValue(t,h);if(e.featureStart(0,f),null!=u&&c){if((0,D.Sl)(l)){var v,d=(0,a.Z)(c);try{for(d.s();!(v=d.n()).done;){v.value.bindFeature(t,r,i)}}catch(p){d.e(p)}finally{d.f()}}var _,y=(0,a.Z)(c);try{for(y.s();!(_=y.n()).done;){_.value.write(e,t,n,o)}}catch(p){y.e(p)}finally{y.f()}if(null!=s&&e.hasRecords){var x=s&&this._findLabelRef(c);this._writeLabels(e,t,s,x,n,o)}e.featureEnd()}}},{key:"_getSortKeyValue",value:function(e,t){var r=this._schema.mesh.sortKey;if(null==r)return 0;var i=0;return i=!0===r.byRenderer&&null!=t.sortKey?t.sortKey:null!=r.fieldIndex?e.getComputedNumericAtIndex(r.fieldIndex):null!=r.field?e.readAttribute(r.field):e.readAttribute(this._idField),null==(i*="asc"===r.order?1:-1)||isNaN(i)?0:i}},{key:"_findLabelRef",value:function(e){var t,r=(0,a.Z)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i instanceof U.Z)return i}}catch(n){r.e(n)}finally{r.f()}return null}},{key:"_writeLabels",value:function(e,t,r,i,n,s){var o,l=(0,a.Z)(r);try{for(l.s();!(o=l.n()).done;){var u=o.value;if(null!=u&&u){var h=u.glyphs,c=u.rtl,f=u.index,v=this._labelTemplates.get(f);if(!v)continue;v.setZoomLevel(n),v.bindReferenceTemplate(i),v.bindTextInfo(h,c),v.write(e,t,null,s)}}}catch(d){l.e(d)}finally{l.f()}}}]),e}()},59697:function(e,t,r){r.d(t,{Z:function(){return g}});var i=r(29439),n=r(15671),a=r(43144),s=r(60136),o=r(29388),l=r(17842),u=r(22018),h=r(11245),c=r(88396),f=r(15245),v=r(23895),d=r(8827),_=r(94109),y=r(80613),x=r(73271),p=r(54815),m=3.14159265359/180,g=function(e){return function(e){(0,s.Z)(r,e);var t=(0,o.Z)(r);function r(){var e;(0,n.Z)(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).angle=0,e.xOffset=0,e.yOffset=0,e.width=0,e.height=0,e.boundsType="square",e._anchorX=0,e._anchorY=0,e._computedWidth=0,e._computedHeight=0,e._allowBorrowing=!0,e._vertexBoundsScaleX=1,e._vertexBoundsScaleY=1,e.geometryType=y.LW.MARKER,e}return(0,a.Z)(r,[{key:"_write",value:function(e,t,r,i){var n=t.getDisplayId();e.recordStart(n,this._materialKey,this.geometryType,!0),this._writeGeometry(e,t,n,r,i),e.recordEnd()}},{key:"_writeGeometry",value:function(e,t,r,n,a){var s=this;if(null!=this._markerPlacement)return this._writePlacedMarkers(e,t,n,a);if(this._allowBorrowing=!0,!a&&"esriGeometryPoint"===t.geometryType){var o=t.getX(),l=t.getY();if(!e.hasAggregates&&e.hasPixelBufferEnabled&&(o<0||o>=513||l<0||l>=513))return;return this._writeVertices(e,r,this._getPos(o,l),o,l)}var u=a?a.asOptimized():"esriGeometryPolygon"===t.geometryType?t.readCentroid():t.readGeometryForDisplay();if(null!=u){if(u.isPoint){var h=(0,i.Z)(u.coords,2),c=h[0],f=h[1];if(!e.hasAggregates&&e.hasPixelBufferEnabled&&(c<0||c>=512||f<0||f>=512))return;return this._writeVertices(e,r,this._getPos(c,f),c,f)}u.forEachVertex((function(t,i){var n=2*_.I_;t<-n||t>=n||i<-n||i>=n||s._writeVertices(e,r,s._getPos(t,i),t,i)}))}}},{key:"_writePlacedMarkers",value:function(e,t,r,i){var n=i||v.z.fromFeatureSetReaderCIM(t);if(n){var a=d.i.getPlacement(n,-1,this._markerPlacement,(0,l.F2)(1),e.tileKey,r.geometryEngine);if(a){this._allowBorrowing="esriGeometryPolygon"!==t.geometryType;for(var s=t.getDisplayId(),o=(0,f.c)(),u=(0,h.c)(),c=a.next();null!=c;){var _=c.tx,y=-c.ty;_>=-128&&_<=640&&y>=-128&&y<=640&&(this._applyTransformation(u,o,-c.getAngle()/m),this._writeVertices(e,s,this._getPos(_,y),_,y)),c=a.next()}}}}},{key:"_writeVertices",value:function(e,t,r,i,n){var a=p.mE.load(this._materialKey);return a.symbologyType===y.mD.HEATMAP?this._writeHeatmapVertices(e,t,r):this._writeMarkerVertices(e,t,a,r,i,n)}},{key:"_writeMarkerVertices",value:function(e,t,r,i,n,a){var s=r.vvRotation,o=e.vertexCount(),l=this._computedWidth*this._vertexBoundsScaleX,u=this._computedHeight*this._vertexBoundsScaleY;if(this.angle){var h=Math.max(l,u);l=h,u=h}if(s){var c=Math.max(this.xOffset,this.yOffset);l+=c,u+=c}this._allowBorrowing&&e.vertexBounds(n+this.xOffset,a-this.yOffset,l,u),e.vertexWrite(i),e.vertexWrite(this._offsetUpperLeft),e.vertexWrite(this._texUpperLeft),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),e.vertexWrite(i),e.vertexWrite(this._offsetUpperRight),e.vertexWrite(this._texUpperRight),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),e.vertexWrite(i),e.vertexWrite(this._offsetBottomLeft),e.vertexWrite(this._texBottomLeft),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),e.vertexWrite(i),e.vertexWrite(this._offsetBottomRight),e.vertexWrite(this._texBottomRight),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),this._writeIndices(e,o)}},{key:"_writeHeatmapVertices",value:function(e,t,r){var i=e.vertexCount();e.vertexWrite(r),e.vertexWrite(this._offsetUpperLeft),e.vertexWrite(t),e.vertexEnd(),e.vertexWrite(r),e.vertexWrite(this._offsetUpperRight),e.vertexWrite(t),e.vertexEnd(),e.vertexWrite(r),e.vertexWrite(this._offsetBottomLeft),e.vertexWrite(t),e.vertexEnd(),e.vertexWrite(r),e.vertexWrite(this._offsetBottomRight),e.vertexWrite(t),e.vertexEnd(),this._writeIndices(e,i)}},{key:"_writeIndices",value:function(e,t){e.indexWrite(t+0),e.indexWrite(t+1),e.indexWrite(t+2),e.indexWrite(t+1),e.indexWrite(t+3),e.indexWrite(t+2)}},{key:"_applyTransformation",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;r?(0,u.b)(e,m*r):(0,u.c)(e),(0,u.t)(e,e,(0,f.f)(this.xOffset,-this.yOffset)),this.angle&&(0,u.r)(e,e,m*this.angle);var i=this._computedWidth,n=this._computedHeight,a=-(.5+this._anchorX)*i,s=-(.5-this._anchorY)*n;(0,c.s)(t,a,s),(0,c.t)(t,t,e),this._offsetUpperLeft=(0,x.UJ)(16*t[0],16*t[1]),(0,c.s)(t,a+i,s),(0,c.t)(t,t,e),this._offsetUpperRight=(0,x.UJ)(16*t[0],16*t[1]),(0,c.s)(t,a,s+n),(0,c.t)(t,t,e),this._offsetBottomLeft=(0,x.UJ)(16*t[0],16*t[1]),(0,c.s)(t,a+i,s+n),(0,c.t)(t,t,e),this._offsetBottomRight=(0,x.UJ)(16*t[0],16*t[1])}},{key:"_computeSize",value:function(e,t,r,i,n,a,s,o){var l=e*r,u=t*r;if(a.sdf&&!s){var h=o&&e>t?l:e,c=t,f=i+2;e=Math.min(h+f,l),t=Math.min(c+f,u)}else e=l,t=u;var v=_.X0/Math.max(l,u),d=.5*(l-e)*v,y=.5*(u-t)*v,p=a.rect.x+_.fL+d,m=a.rect.y+_.fL+y,g=p+a.width-2*d,k=m+a.height-2*y,w=Math.floor(p),b=Math.floor(m),M=Math.ceil(g),Z=Math.ceil(k);e*=(M-w)/(g-p),t*=(Z-b)/(k-m),this._texUpperLeft=(0,x.UJ)(w,b),this._texUpperRight=(0,x.UJ)(M,b),this._texBottomLeft=(0,x.UJ)(w,Z),this._texBottomRight=(0,x.UJ)(M,Z),this._anchorX*=l/e,this._anchorY*=u/t,e*=n,t*=n,this._computedWidth=e,this._computedHeight=t}},{key:"_getPos",value:function(e,t){return(0,x.UJ)(Math.round(8*e),Math.round(8*t))}}]),r}(e)}},5748:function(e,t,r){r.d(t,{Z:function(){return S}});var i=r(37762),n=r(29439),a=r(15671),s=r(43144),o=r(60136),l=r(29388),u=r(17842),h=r(23895),c=r(8827),f=r(94109),v=r(80613),d=r(73271),_=r(54815),y=r(47975),x=(0,d.UJ)(4,4),p=(0,d.UJ)(16,4),m=(0,d.UJ)(4,2),g=(0,d.UJ)(4,6),k=[m,m,g,g],w=[m,g,m,g],b=[g,g,x,x],M=[x,x,g,g],Z=[g,x,g,x],L=[x,g,x,g],S=function(e){return function(e){(0,o.Z)(r,e);var t=(0,l.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n)))._isCIM=!1,e._vertexBoundsScale=1,e.geometryType=v.LW.TEXT,e._aux=(0,d.Jz)(0,0,e._referenceSize,e._bitset),e}return(0,s.Z)(r,[{key:"bindTextInfo",value:function(e,t){e&&e.length?this._shapingInfo=(0,y.Nr)(e,t,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:f.xm*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM,hasBackground:!!this._backgroundColor,borderLineSize:this._borderLineSize}):this._shapingInfo=null}},{key:"_write",value:function(e,t,r,i){var n=t.getDisplayId();this._writeGeometry(e,t,n,r,i)}},{key:"_writeGeometry",value:function(e,t,r,i,a){var s=this,o=this._shapingInfo;if(null!=o){if(this._textPlacement)return this._writePlacedText(e,r,o,i,t,a);var l=a?a.asOptimized():"esriGeometryPolygon"===t.geometryType?t.readCentroid():t.readGeometryForDisplay();if(null!=l){if(l.isPoint){var u=(0,n.Z)(l.coords,2),h=u[0],c=u[1];if(!e.hasAggregates&&e.hasPixelBufferEnabled&&(h<0||h>=512||c<0||c>=512))return;return this._writeGlyphs(e,r,{x:h,y:c},o)}l.forEachVertex((function(t,i){return s._writeGlyphs(e,r,{x:t,y:i},o)}))}}}},{key:"_writePlacedText",value:function(e,t,r,i,n,a){var s=this._textPlacement,o=a||h.z.fromFeatureSetReaderCIM(n);if(o){var l=c.i.getPlacement(o,-1,s,(0,u.F2)(1),e.tileKey,i.geometryEngine);if(l)for(var f,v,d,_=r.bounds,y=Math.sqrt(_.height*_.height+_.width*_.width);f=l.next();)if(v=f.tx,d=-f.ty,v+y>=0&&v-y<512&&d+y>=0&&d-y<512){var x=-f.getAngle();r.setRotation(x),this._writeGlyphs(e,t,{x:v,y:d},r),r.setRotation(-x)}}}},{key:"_writeGlyphs",value:function(e,t,r,n){var a=_.m2.load(this._materialKey),s=(0,d.UJ)(Math.round(8*r.x),Math.round(8*r.y)),o=this._vertexBoundsScale,l=n.bounds,u=n.background,h=n.glyphs;h.length>0&&(this._borderLineColor||this._backgroundColor)&&(a.textureBinding=h[0].textureBinding,e.recordStart(t,a.data,this.geometryType,!0),this._writeBackgroundGeometry(e,t,r,l,u),e.recordEnd());var c,f=2*Math.max(l.width,l.height),v=(0,i.Z)(n.glyphs);try{for(v.s();!(c=v.n()).done;){var y=c.value;a.textureBinding=y.textureBinding,e.recordStart(t,a.data,this.geometryType,!0),e.vertexBounds(r.x+l.x+this._xOffset,r.y+l.y-this._yOffset,f*o,f*o),this._writeVertices(e,t,s,y),e.recordEnd()}}catch(x){v.e(x)}finally{v.f()}}},{key:"_writeGlyph",value:function(e,t,r,i,n){var a=_.m2.load(this._materialKey),s=(0,d.UJ)(Math.round(8*r),Math.round(8*i));a.textureBinding=n.textureBinding,e.recordStart(t,a.data,this.geometryType,!0);var o=n.bounds,l=this._vertexBoundsScale;e.vertexBounds(r+o.x*l,i+o.y*l,o.width*l,o.height*l),this._writeVertices(e,t,s,n),e.recordEnd()}},{key:"_writeVertices",value:function(e,t,r,i){var n=e.vertexCount();this._writeVertexCommon(e,t,r,i),e.vertexWrite(i.offsets.upperLeft),e.vertexWrite(i.texcoords.upperLeft),e.vertexEnd(),this._writeVertexCommon(e,t,r,i),e.vertexWrite(i.offsets.upperRight),e.vertexWrite(i.texcoords.upperRight),e.vertexEnd(),this._writeVertexCommon(e,t,r,i),e.vertexWrite(i.offsets.lowerLeft),e.vertexWrite(i.texcoords.lowerLeft),e.vertexEnd(),this._writeVertexCommon(e,t,r,i),e.vertexWrite(i.offsets.lowerRight),e.vertexWrite(i.texcoords.lowerRight),e.vertexEnd(),e.indexWrite(n+0),e.indexWrite(n+1),e.indexWrite(n+2),e.indexWrite(n+1),e.indexWrite(n+3),e.indexWrite(n+2)}},{key:"_writeVertexCommon",value:function(e,t,r,i){var n=this._color,a=this._haloColor,s=(0,d.Jz)(0,0,this._referenceSize,this._bitset),o=(0,d.Jz)(0,0,this._size,this._haloSize);e.vertexWrite(r),e.vertexWrite(t),e.vertexWrite(n),e.vertexWrite(a),e.vertexWrite(o),e.vertexWrite(s),e.vertexWrite(this._minMaxZoom)}},{key:"_writeBackgroundVertex",value:function(e,t,r,i,n,a){var s=(0,d.Jz)(0,1,this._referenceSize,this._bitset),o=(0,d.Jz)(0,0,this._size,this._haloSize),l=(0,d.Jz)(0,0,0,0);e.vertexWrite(r),e.vertexWrite(t),e.vertexWrite(i),e.vertexWrite(l),e.vertexWrite(o),e.vertexWrite(s),e.vertexWrite(this._minMaxZoom),e.vertexWrite(n),e.vertexWrite(a),e.vertexEnd()}},{key:"_writeBackgroundQuad",value:function(e,t,r,i,n,a){var s=e.vertexCount();this._writeBackgroundVertex(e,t,r,i,n.upperLeft,a[0]),this._writeBackgroundVertex(e,t,r,i,n.upperRight,a[1]),this._writeBackgroundVertex(e,t,r,i,n.lowerLeft,a[2]),this._writeBackgroundVertex(e,t,r,i,n.lowerRight,a[3]),e.indexWrite(s+0),e.indexWrite(s+1),e.indexWrite(s+2),e.indexWrite(s+1),e.indexWrite(s+3),e.indexWrite(s+2)}},{key:"_writeBackgroundGeometry",value:function(e,t,r,i,a){var s=(0,d.UJ)(Math.round(8*r.x),Math.round(8*r.y)),o=i.x,l=i.y,u=i.width,h=i.height,c=2*Math.max(u,h);if(e.vertexBounds(r.x+o+this._xOffset,r.y+l-this._yOffset,c*this._vertexBoundsScale,c*this._vertexBoundsScale),this._backgroundColor){var f=[p,p,p,p];this._writeBackgroundQuad(e,t,s,this._backgroundColor,a.main,f)}if(this._borderLineColor||this._backgroundColor){var v=!!this._borderLineColor&&!!this._borderLineSize&&this._borderLineSize>0?[k,k,w,w,this._borderLineColor]:[b,M,Z,L,this._backgroundColor],_=(0,n.Z)(v,5),y=_[0],x=_[1],m=_[2],g=_[3],S=_[4];this._writeBackgroundQuad(e,t,s,S,a.top,y),this._writeBackgroundQuad(e,t,s,S,a.bot,x),this._writeBackgroundQuad(e,t,s,S,a.left,m),this._writeBackgroundQuad(e,t,s,S,a.right,g)}}}]),r}(e)}},64580:function(e,t,r){r.d(t,{Z:function(){return g}});var i=r(29439),n=r(15671),a=r(43144),s=r(60136),o=r(29388),l=r(17842),u=r(11245),h=r(15245),c=r(48202),f=r(65800),v=r(94109),d=r(80613),_=r(73271),y=r(54815),x=r(42093),p=r(59697),m=r(52993),g=function(e){(0,s.Z)(r,e);var t=(0,o.Z)(r);function r(e,i,a,s,o,l,f,x,p,m,g,k,w,b,M,Z,L,S,T,z,W,P,I,C){var F;(0,n.Z)(this,r),(F=t.call(this)).angle=s,F.height=f,F.width=l,F.xOffset=i*T,F.yOffset=a*T,F._markerPlacement=z||void 0,F._effects=W||void 0,F._anchorX=Z,F._anchorY=L,F._minMaxZoom=(0,_.UJ)(Math.round(P*v.MI),Math.round(I*v.MI));var E=(b===c.v2.MAP?v.Tz:v.CQ)|(g?v.Uh:0)|(w?v.oK:0)|(k?v.e0:0),A=M&&M.sdf,R=y.mE.load(e);R.sdf=A,R.pattern=!0,R.textureBinding=M.textureBinding,F._materialKey=R.data,F._fillColor=o,F._outlineColor=p,F._sizeOutlineWidth=(0,_.Jz)(Math.round(Math.min(Math.sqrt(128*l),255)),Math.round(Math.min(Math.sqrt(128*f),255)),Math.round(Math.min(Math.sqrt(128*m),255)),Math.round(Math.min(Math.sqrt(128*x),255))),R.symbologyType===d.mD.PIE_CHART?(l*=S*T,f*=S*T,F._computedWidth=l,F._computedHeight=f,F._texUpperLeft=(0,_.UJ)(0,1),F._texUpperRight=(0,_.UJ)(1,1),F._texBottomLeft=(0,_.UJ)(0,0),F._texBottomRight=(0,_.UJ)(1,0)):F._computeSize(l,f,S,m,T,M,R.hasSizeVV(),C);var B=Math.round(64*S);F._bitestAndDistRatio=(0,_.UJ)(E,B);var O=(0,h.c)(),V=(0,u.c)();return F._applyTransformation(V,O),F}return(0,a.Z)(r,null,[{key:"fromCIMMarker",value:function(e,t,n){var a,s=t&&t.width||1,o=t&&t.height||1,u=e.size,h=s/o*e.scaleX,v=e.scaleSymbolsProportionally&&e.frameHeight?u/e.frameHeight:1,d=(0,f.t2)(e.color),_=(0,f.t2)(e.outlineColor),y=(0,l.F2)(u),p=y*h,m=(0,l.F2)(e.offsetX||0),g=(0,l.F2)(e.offsetY||0),k=(0,l.F2)(e.outlineWidth||0)*v,w=e.alignment||c.v2.SCREEN,b=(0,l.F2)(e.referenceSize),M=(0,x._f)(e.scaleInfo,n),Z=(0,i.Z)(M,2),L=Z[0],S=Z[1],T=e.rotation||0;e.rotateClockwise||(T=-T);var z=0,W=0,P=e.anchorPoint;P&&(e.isAbsoluteAnchorPoint?u&&(z=P.x/(u*h),W=P.y/u):(z=P.x,W=P.y));var I=new r(e.materialKey,m,g,T,d,p,y,b,_,k,e.colorLocked,e.scaleSymbolsProportionally,!1,w,t,z,W,e.sizeRatio,null!==(a=e.scaleFactor)&&void 0!==a?a:1,e.markerPlacement,e.effects,L,S,!0);return I._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/p:1,I._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/y:1,I}},{key:"fromPictureMarker",value:function(e,t){var i=Math.round((0,l.F2)(e.width)),n=Math.round((0,l.F2)(e.height)),a=v.ru,s=Math.round((0,l.F2)(e.xoffset||0)),o=Math.round((0,l.F2)(e.yoffset||0)),u=new r(e.materialKey,s,o,e.angle,a,i,n,n,0,0,!1,!1,!1,c.v2.SCREEN,t,0,0,1,1,null,null,x.Xe,x.eW,!1);return u._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/e.width:1,u._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/e.height:1,u}},{key:"fromSimpleMarker",value:function(e,t){var i,n=e.style,a=(0,f.aH)(e.color),s=Math.round((0,l.F2)(e.size)),o=s;"esriSMSTriangle"===n&&(o*=t.height/t.width);var u=Math.round((0,l.F2)(e.xoffset||0)),h=Math.round((0,l.F2)(e.yoffset||0)),v=e.outline,d=0|((null===v||void 0===v?void 0:v.color)&&(0,f.aH)(v.color)),_=0|((null===v||void 0===v?void 0:v.width)&&Math.round((0,l.F2)(v.width))),y=new r(e.materialKey,u,h,null!==(i=e.angle)&&void 0!==i?i:0,a,s,o,o,d,_,!1,!1,"esriSMSCross"===n||"esriSMSX"===n,c.v2.SCREEN,t,0,0,2,1,null,null,x.Xe,x.eW,!1);return y.boundsType="esriSMSCircle"===n?"circle":"square",y._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/e.size:1,y._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/e.size:1,y}},{key:"fromLineSymbolMarker",value:function(e,t){var i,n=(0,f.aH)(e.color),a=Math.round((0,l.F2)(6*e.lineWidth)),s=a,o="cross"===e.style||"x"===e.style;switch(e.placement){case"begin-end":i=c.Tx.Both;break;case"begin":i=c.Tx.JustBegin;break;case"end":i=c.Tx.JustEnd;break;default:i=c.Tx.None}var u={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:i,offsetAlongLine:0},h=new r(e.materialKey,0,0,0,n,a,s,s/6,n,o?Math.round((0,l.F2)(e.lineWidth)):0,!1,!1,o,c.v2.MAP,t,0,0,2,1,u,null,x.Xe,x.eW,!1);return h.boundsType="circle"===e.style?"circle":"square",h}}]),r}((0,p.Z)(m.Z))},52993:function(e,t,r){r.d(t,{Z:function(){return o}});var i=r(15671),n=r(43144),a=r(23895),s=r(95954),o=function(){function e(){(0,i.Z)(this,e),this._materialKey=null}return(0,n.Z)(e,[{key:"bindFeature",value:function(e,t,r){}},{key:"write",value:function(e,t,r,i){if(this._effects&&this._effects.length>0){var n=a.z.fromFeatureSetReaderCIM(t);if(n){n.invertY();for(var o=s.j.executeEffects(this._effects,n,e.tileKey,i.geometryEngine);n=o.next();)n.invertY(),this._write(e,t,i,n)}}else this._write(e,t,i)}},{key:"_write",value:function(e,t,r,i){}}]),e}()},61909:function(e,t,r){r.d(t,{Wr:function(){return je},Sl:function(){return qe}});var i=r(74165),n=r(15861),a=r(37762),s=r(15671),o=r(43144),l=r(1413),u=r(10064),h=r(32718),c=r(66978),f=r(76115),v=r(80613),d=r(54815),_=r(29439),y=r(82963),x=r(60136),p=r(29388),m=r(17842),g=r(31027),k=r(65800),w=r(94109),b=r(13200),M=r(73271),Z=r(42093),L=r(84319),S=(r(79347),r(48035)),T=r(40316),z=r(80457);function W(e,t,r,i,n,a,s){te=0;var o,l,u,h,c,f=(i-r)*a,v=n&&n.length,d=v?(n[0]-r)*a:f,_=P(t,r,i,0,d,a,!0);if(_&&_.next!==_.prev){if(v&&(_=O(t,r,i,n,_,a)),f>80*a){o=u=t[0+r*a],l=h=t[1+r*a];for(var y=a;y<d;y+=a){var x=t[y+r*a],p=t[y+1+r*a];o=Math.min(o,x),l=Math.min(l,p),u=Math.max(u,x),h=Math.max(h,p)}c=0!==(c=Math.max(u-o,h-l))?1/c:0}C(_,e,a,o,l,c,s,0)}}function P(e,t,r,i,n,a,s){var o;if(s===function(e,t,r,i,n,a){for(var s=0,o=i,l=n-a;o<n;o+=a)s+=(e[l+t*a]-e[o+t*a])*(e[o+1+t*a]+e[l+1+t*a]),l=o;return s}(e,t,0,i,n,a)>0)for(var l=i;l<n;l+=a)o=A(l+t*a,e[l+t*a],e[l+1+t*a],o);else for(var u=n-a;u>=i;u-=a)o=A(u+t*a,e[u+t*a],e[u+1+t*a],o);return o&&X(o,o.next)&&(R(o),o=o.next),o}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!e)return e;var r,i=e;do{if(r=!1,i.steiner||!X(i,i.next)&&0!==D(i.prev,i,i.next))i=i.next;else{if(R(i),(i=t=i.prev)===i.next)break;r=!0}}while(r||i!==t);return t}function C(e,t,r,i,n,a,s,o){if(e){!o&&a&&(e=U(e,i,n,a));for(var l=e;e.prev!==e.next;){var u=e.prev,h=e.next;if(a?E(e,i,n,a):F(e))t.push(u.index/r+s),t.push(e.index/r+s),t.push(h.index/r+s),R(e),e=h.next,l=h.next;else if((e=h)===l){o?1===o?C(e=Y(e,t,r,s),t,r,i,n,a,s,2):2===o&&q(e,t,r,i,n,a,s):C(I(e),t,r,i,n,a,s,1);break}}}}function F(e){var t=e.prev,r=e,i=e.next;if(D(t,r,i)>=0)return!1;for(var n=e.next.next,a=n,s=0;n!==e.prev&&(0===s||n!==a);){if(s++,K(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&D(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function E(e,t,r,i){var n=e.prev,a=e,s=e.next;if(D(n,a,s)>=0)return!1;for(var o=n.x<a.x?n.x<s.x?n.x:s.x:a.x<s.x?a.x:s.x,l=n.y<a.y?n.y<s.y?n.y:s.y:a.y<s.y?a.y:s.y,u=n.x>a.x?n.x>s.x?n.x:s.x:a.x>s.x?a.x:s.x,h=n.y>a.y?n.y>s.y?n.y:s.y:a.y>s.y?a.y:s.y,c=J(o,l,t,r,i),f=J(u,h,t,r,i),v=e.prevZ,d=e.nextZ;v&&v.z>=c&&d&&d.z<=f;){if(v!==e.prev&&v!==e.next&&K(n.x,n.y,a.x,a.y,s.x,s.y,v.x,v.y)&&D(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,d!==e.prev&&d!==e.next&&K(n.x,n.y,a.x,a.y,s.x,s.y,d.x,d.y)&&D(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;v&&v.z>=c;){if(v!==e.prev&&v!==e.next&&K(n.x,n.y,a.x,a.y,s.x,s.y,v.x,v.y)&&D(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;d&&d.z<=f;){if(d!==e.prev&&d!==e.next&&K(n.x,n.y,a.x,a.y,s.x,s.y,d.x,d.y)&&D(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function A(e,t,r,i){var n=$.create(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function R(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function B(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function O(e,t,r,i,n,a){for(var s=new Array,o=0,l=i.length;o<l;o++){var u=P(e,t,0,i[o]*a,o<l-1?i[o+1]*a:r*a,a,!1);u===u.next&&(u.steiner=!0),s.push(B(u))}s.sort(H);for(var h=0,c=s;h<c.length;h++){n=V(c[h],n)}return n}function V(e,t){var r=function(e,t){var r,i=t,n=e.x,a=e.y,s=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var o=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(o<=n&&o>s){if(s=o,o===n){if(a===i.y)return i;if(a===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!r)return null;if(n===s)return r.prev;var l,u=r,h=r.x,c=r.y,f=1/0;for(i=r.next;i!==u;)n>=i.x&&i.x>=h&&n!==i.x&&K(a<c?n:s,a,h,c,a<c?s:n,a,i.x,i.y)&&((l=Math.abs(a-i.y)/(n-i.x))<f||l===f&&i.x>r.x)&&N(i,e)&&(r=i,f=l),i=i.next;return r}(e,t);if(!r)return t;var i=Q(r,e);return I(i,i.next),I(r,r.next)}function U(e,t,r,i){for(var n;n!==e;n=n.next){if(null===(n=n||e).z&&(n.z=J(n.x,n.y,t,r,i)),n.prev.next!==n||n.next.prev!==n)return n.prev.next=n,n.next.prev=n,U(e,t,r,i);n.prevZ=n.prev,n.nextZ=n.next}return e.prevZ.nextZ=null,e.prevZ=null,function(e){for(var t,r=1;;){var i=void 0,n=e;e=null,t=null;for(var a=0;n;){a++,i=n;for(var s=0;s<r&&i;s++)i=i.nextZ;for(var o=r;s>0||o>0&&i;){var l=void 0;0===s?(l=i,i=i.nextZ,o--):0!==o&&i?n.z<=i.z?(l=n,n=n.nextZ,s--):(l=i,i=i.nextZ,o--):(l=n,n=n.nextZ,s--),t?t.nextZ=l:e=l,l.prevZ=t,t=l}n=i}if(t.nextZ=null,r*=2,a<2)return e}}(e)}function D(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function G(e,t,r,i){return!!(X(e,t)&&X(r,i)||X(e,i)&&X(r,t))||D(e,t,r)>0!=D(e,t,i)>0&&D(r,i,e)>0!=D(r,i,t)>0}function K(e,t,r,i,n,a,s,o){return(n-s)*(t-o)-(e-s)*(a-o)>=0&&(e-s)*(i-o)-(r-s)*(t-o)>=0&&(r-s)*(a-o)-(n-s)*(i-o)>=0}function N(e,t){return D(e.prev,e,e.next)<0?D(e,t,e.next)>=0&&D(e,e.prev,t)>=0:D(e,t,e.prev)<0||D(e,e.next,t)<0}function J(e,t,r,i,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function X(e,t){return e.x===t.x&&e.y===t.y}function H(e,t){return e.x-t.x}function Y(e,t,r,i){var n=e;do{var a=n.prev,s=n.next.next;!X(a,s)&&G(a,n,n.next,s)&&N(a,s)&&N(s,a)&&(t.push(a.index/r+i),t.push(n.index/r+i),t.push(s.index/r+i),R(n),R(n.next),n=e=s),n=n.next}while(n!==e);return n}function q(e,t,r,i,n,a,s){var o=e;do{for(var l=o.next.next;l!==o.prev;){if(o.index!==l.index&&j(o,l)){var u=Q(o,l);return o=I(o,o.next),u=I(u,u.next),C(o,t,r,i,n,a,s,0),void C(u,t,r,i,n,a,s,0)}l=l.next}o=o.next}while(o!==e)}function j(e,t){return e.next.index!==t.index&&e.prev.index!==t.index&&!function(e,t){var r=e;do{if(r.index!==e.index&&r.next.index!==e.index&&r.index!==t.index&&r.next.index!==t.index&&G(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&N(e,t)&&N(t,e)&&function(e,t){var r=e,i=!1,n=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&n<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==e);return i}(e,t)}function Q(e,t){var r=$.create(e.index,e.x,e.y),i=$.create(t.index,t.x,t.y),n=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,a.next=i,i.prev=a,i}for(var $=function(){function e(){(0,s.Z)(this,e),this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return(0,o.Z)(e,null,[{key:"create",value:function(t,r,i){var n=te<ee.length?ee[te++]:new e;return n.index=t,n.x=r,n.y=i,n.prev=null,n.next=null,n.z=null,n.prevZ=null,n.nextZ=null,n.steiner=!1,n}}]),e}(),ee=new Array,te=0,re=0;re<8096;re++)ee.push(new $);var ie=new T.bN(0,0,0,1,0),ne=new T.bN(0,0,0,1,0);function ae(e,t,r){for(var i=0,n=1;n<r;n++){var a=e[2*(t+n-1)],s=e[2*(t+n-1)+1];i+=(e[2*(t+n)]-a)*(e[2*(t+n)+1]+s)}return i}function se(e,t,r,i,n){for(var a=0,s=r;s<i;s+=3){var o=2*(e[s]-n),l=2*(e[s+1]-n),u=2*(e[s+2]-n);a+=Math.abs((t[o]-t[u])*(t[l+1]-t[o+1])-(t[o]-t[l])*(t[u+1]-t[o+1]))}return a}ie.setExtent(w.I_),ne.setExtent(w.I_);var oe=r(48202),le=r(23895),ue=r(82010),he=16,ce=function(e){return function(e){(0,x.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;(0,s.Z)(this,r);for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))).tessellationProperties={},e._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0},e.geometryType=v.LW.LINE,e}return(0,o.Z)(r,[{key:"writeGeometry",value:function(e,t,r,i){this._writeGeometry(e,t,r,i)}},{key:"_initializeTessellator",value:function(e){var t=d.a.load(this._materialKey),r=d.dk.load(this._materialKey),i=this._tessellationOptions,n=t.vvSizeFieldStops||t.vvSizeMinMaxValue||t.vvSizeScaleStops||t.vvSizeUnitValue,a=this.tessellationProperties._halfWidth<w.tQ&&!e&&!n;this.tessellationProperties.minMaxZoom=this._minMaxZoom,i.wrapDistance=65535,i.textured=this._isDashed||this._hasPattern,i.offset=this.tessellationProperties.offset,i.halfWidth=this.tessellationProperties._halfWidth;var s=a?0:1,o=(0,d.CA)(r)?ve:fe;this._lineTessellator=new ue.z(o(this.tessellationProperties,s,s),de(this.tessellationProperties),a)}},{key:"_write",value:function(e,t,r,i){var n="esriGeometryPoint"===t.geometryType;e.recordStart(t.getDisplayId(),this._materialKey,this.geometryType,n),this._writeGeometry(e,t,i,n),e.recordEnd()}},{key:"_writeGeometry",value:function(e,t,r,i){var n=r||le.z.fromFeatureSetReaderCIM(t);if(n){var a=this._getLines(n,i);null!=a&&this._writeVertices(e,t,a)}}},{key:"_getLines",value:function(e,t){return function(e,t){ne.setPixelMargin(t);var r=ne,i=-t,n=w.I_+t,s=[],o=!1;if(!e.nextPath())return null;for(var l=!0;l;){e.seekPathStart();var u=[];if(!e.numPoints)return null;r.reset(T.Vl.LineString),e.nextPoint();var h=e.x,c=e.y;if(o)r.moveTo(h,c);else{if(h<i||h>n||c<i||c>n){o=!0;continue}u.push({x:h,y:c})}for(var f=!1;e.nextPoint();)if(h=e.x,c=e.y,o)r.lineTo(h,c);else{if(h<i||h>n||c<i||c>n){f=!0;break}u.push({x:h,y:c})}if(f)o=!0;else{if(o){var v=r.resultWithStarts();if(v){var d,_=(0,a.Z)(v);try{for(_.s();!(d=_.n()).done;){var y=d.value;s.push(y)}}catch(x){_.e(x)}finally{_.f()}}}else s.push({line:u,start:0});l=e.nextPath(),o=!1}}return s=s.filter((function(e){return e.line.length>1})),0===s.length?null:s}(e,t?256:16)}},{key:"_writeVertices",value:function(e,t,r){var i=t.getDisplayId(),n=e.vertexCount(),s=this.tessellationProperties,o=this._tessellationOptions;s.out=e,s.id=i,s.indexCount=0,s.vertexCount=0,s.offset=n,o.capType=this._capType,o.joinType=this._joinType;var l=d.dk.load(this._materialKey);this.tessellationProperties.key=(0,d.CA)(l)?l:d.a.load(this._materialKey);var u,h=(0,a.Z)(r);try{for(h.s();!(u=h.n()).done;){var c=u.value,f=c.line,v=c.start;o.initialDistance=v%65535,this._lineTessellator.tessellate(f,o)}}catch(_){h.e(_)}finally{h.f()}}}]),r}(e)},fe=function(e,t,r){return function(i,n,a,s,o,l,u,h,c,f,v){var d=(0,M.UJ)(v,Math.ceil(he*e._halfWidth)),_=(0,M.Jz)(Math.round(he*u),Math.round(he*h),Math.round(he*c),Math.round(he*f)),y=(0,M.Jz)(he*o,he*l,0,e._bitset),x=e.out;return x.vertexBounds(i,n,t,r),x.vertexWrite((0,M.UJ)(8*i,8*n)),x.vertexWrite(e.id),x.vertexWrite(e._fillColor),x.vertexWrite(_),x.vertexWrite(d),x.vertexWrite(e._tl),x.vertexWrite(e._br),x.vertexWrite(y),x.vertexWrite((0,M.UJ)(Math.ceil(he*e._halfReferenceWidth),0)),x.vertexWrite(e.minMaxZoom),x.vertexEnd(),e.offset+e.vertexCount++}},ve=function(e,t,r){return function(i,n,a,s,o,l,u,h,c,f,v){var _=(0,M.UJ)(he*e._halfWidth,he*e._halfReferenceWidth),y=(0,M.Jz)(he*u+128,he*h+128,he*c+128,he*f+128),x=e.out,p=e._bitset<<24|e.id;x.vertexBounds(i,n,t,r),x.vertexWrite((0,M.UJ)(8*i,8*n)),x.vertexWrite(p),x.vertexWrite(e._fillColor);var m=(0,d.Xp)(e.key);return m||(x.vertexWrite(0),x.vertexWrite(0)),x.vertexWrite(0),x.vertexWrite(_),x.vertexWrite(y),m||x.vertexWrite(e.minMaxZoom),x.vertexEnd(),e.offset+e.vertexCount++}},de=function(e){return function(t,r,i){var n=e.out;n.indexWrite(t),n.indexWrite(r),n.indexWrite(i),e.indexCount+=3}},_e=r(52993),ye=function(e){(0,x.Z)(r,e);var t=(0,p.Z)(r);function r(e,i,n,a,o,l,u,h,c,f,v,_,y,x,p,m,g,k,b,L){var S;(0,s.Z)(this,r),S=t.call(this);var T=d.a.load(e);i&&(T.sdf=i.sdf,T.pattern=!0,T.textureBinding=i.textureBinding),S._capType=a,S._joinType=o,S._miterLimitCosine=(0,Z.NW)(l),S.tessellationProperties._fillColor=u,S.tessellationProperties._tl=h,S.tessellationProperties._br=c,S._hasPattern=f,S._isDashed=v,S._zOrder=g,S._effects=k||null,S._minMaxZoom=(0,M.UJ)(Math.round(b*w.MI),Math.round(L*w.MI)),S._materialKey=T.data;var z=(y?w.Uh:0)|(x?w.SD:0)|(_?w._6:0)|(p?w.Iv:0);return S.tessellationProperties._bitset=z,S.tessellationProperties._halfWidth=.5*n,S.tessellationProperties._halfReferenceWidth=.5*m,S.tessellationProperties.offset=0,S._initializeTessellator(!1),S}return(0,o.Z)(r,null,[{key:"fromCIMLine",value:function(e,t,i){var n,a,s,o,l=e.color,u=e.scaleFactor||1,h=!!e.dashTemplate,c=e.cap;h&&c===oe.RL.ROUND&&(c=oe.RL.SQUARE);var f=e.join,v=(0,m.F2)(e.width)*u,d=(0,m.F2)(e.referenceWidth),y=(0,m.F2)(e.miterLimit),x=l&&(0,k.t2)(l)||0,p=(0,Z._f)(e.scaleInfo,i),g=(0,_.Z)(p,2),b=g[0],L=g[1];if(!t)return new r(e.materialKey,t,v,c,f,y,x,0,0,!1,h,null!==(n=e.scaleDash)&&void 0!==n&&n,null!==(a=e.colorLocked)&&void 0!==a&&a,!1,e.sampleAlphaOnly,d,e.zOrder,e.effects,b,L);var S=t.rect,T=t.width,z=t.height,W=S.x+w.fL,P=S.y+w.fL,I=W+T,C=P+z,F=(0,M.UJ)(W,P),E=(0,M.UJ)(I,C);return new r(e.materialKey,t,v,c,f,y,x,F,E,!0,h,null!==(s=e.scaleDash)&&void 0!==s&&s,null!==(o=e.colorLocked)&&void 0!==o&&o,!1,e.sampleAlphaOnly,d,e.zOrder,e.effects,b,L)}},{key:"fromFillOutline",value:function(e){var t,i=d.dk.load(e.materialKey);return(0,d.CA)(i)&&e.outline&&"esriSLSSolid"===(null===(t=e.outline)||void 0===t?void 0:t.style)?r.fromSimpleLine((0,l.Z)({hash:"",materialKey:e.materialKey},e.outline),null,!0):null}},{key:"fromSimpleLine",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.color,a="esriSLSSolid"!==e.style&&"esriSLSNull"!==e.style,s=(0,L.ws)(e.cap||"round"),o=(0,L.xV)(e.join||"round"),l=n&&"esriSLSNull"!==e.style&&(0,k.aH)(n)||0;"esriSLSNull"===e.style&&(l=0);var u=(0,m.F2)(e.width),h=e.miterLimit;if(!t)return new r(e.materialKey,t,u,s,o,h,l,0,0,!1,a,!0,!1,i,!1,u,0,null,Z.Xe,Z.eW);var c=t.rect,f=t.width,v=t.height,d=c.x+w.fL,_=c.y+w.fL,y=d+f,x=_+v,p=(0,M.UJ)(d,_),g=(0,M.UJ)(y,x);return new r(e.materialKey,t,u,s,o,h,l,p,g,!0,a,!0,!1,i,!1,u,0,null,Z.Xe,Z.eW)}},{key:"fromPictureLineSymbol",value:function(e,t,r,i){return h.Z.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate").error("PictureLineSymbol support does not exist!"),null}}]),r}(ce(_e.Z)),xe=function(e){return function(e){(0,x.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;(0,s.Z)(this,r);for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))).forceLibtess=!1,e._bitset=0,e._lineTemplate=null,e.geometryType=v.LW.FILL,e}return(0,o.Z)(r,[{key:"_maybeAddLineTemplate",value:function(e){this._lineTemplate=ye.fromFillOutline(e)}},{key:"_write",value:function(e,t,r,i){var n="esriGeometryPoint"===t.geometryType,a=d.dk.load(this._materialKey);e.recordStart(t.getDisplayId(),this._materialKey,this.geometryType,n),this._writeGeometry(e,t,a,i,n),(0,d.CA)(a)&&null!=this._lineTemplate&&this._lineTemplate.writeGeometry(e,t,i,n),e.recordEnd()}},{key:"_writeGeometry",value:function(e,t,r,i,n){var a=this._getGeometry(t,i,n);if(null!=a){var s=[];if(a.maxLength>100||this.forceLibtess||!function(e,t){var r=t.coords,i=t.lengths,n=e;if(t.hasIndeterminateRingOrder)return!1;for(var a=0,s=0;s<i.length;){for(var o=s,l=i[s],u=ae(r,a,l),h=[];++o<i.length;){var c=i[o],f=ae(r,a+l,c);if(!(f>0))break;u+=f,h.push(a+l),l+=c}var v=n.length;W(n,r,a,a+l,h,2,0);var d=se(n,r,v,n.length,0),_=Math.abs(u);if(Math.abs((d-_)/Math.max(1e-7,_))>1e-5)return n.length=0,!1;s=o,a+=l}return!0}(s,a)){var o=function(e){var t=e.coords,r=e.lengths;return(0,S.b)(t,r).buffer}(a);this._writeVertices(e,t,o,[o.length/2],r)}else s.length&&this._writeVertices(e,t,a.coords,a.lengths,r,s)}}},{key:"_writeVertex",value:function(e,t,r,i,n,a){var s=(0,M.UJ)(1*i,1*n);if(e.vertexBounds(i,n,0,0),e.vertexWrite(s),e.vertexWrite(t),r.symbologyType===v.mD.DOT_DENSITY)e.vertexWriteF32(1/Math.abs(a.readGeometryArea()));else{e.vertexWrite(this.fillColor);var o=(0,d.Xp)(r);o||(e.vertexWrite(this.tl),e.vertexWrite(this.br)),e.vertexWrite(this.aux21),e.vertexWrite(this.aux22),e.vertexWrite(this.aux3),o||e.vertexWrite(this._minMaxZoom)}}},{key:"_writeVertices",value:function(e,t,r,i,n,s){var o=t.getDisplayId(),l=this._bitset<<24|o,u=i.reduce((function(e,t){return e+t})),h=(0,L.$_)(n.geometryType,n.symbologyType).geometry/4,c=e.vertexCount();e.vertexEnsureSize(h*u);var f=0;if(s){var v,d=(0,a.Z)(s);try{for(d.s();!(v=d.n()).done;){var _=v.value,y=r[2*_],x=r[2*_+1];this._writeVertex(e,l,n,y,x,t),f++}}catch(w){d.e(w)}finally{d.f()}}else for(var p=0;p<r.length;p+=2){var m=Math.round(r[p]),g=Math.round(r[p+1]);this._writeVertex(e,l,n,m,g,t),f++}e.indexEnsureSize(f);for(var k=0;k<f;k++)e.indexWrite(k+c)}},{key:"_getGeometry",value:function(e,t,r){var i=(null===t||void 0===t?void 0:t.asOptimized())||e.readGeometryForDisplay();return i?function(e,t){if(null==e)return null;if(!function(e,t,r){for(var i=0,n=0;n<e.lengths.length;n++){for(var a=e.lengths[n],s=0;s<a;s++){var o=e.coords[2*(s+i)],l=e.coords[2*(s+i)+1];if(o<t||o>r||l<t||l>r)return!0}i+=a}return!1}(e,-128,w.I_+128))return e;ie.setPixelMargin(t),ie.reset(T.Vl.Polygon);for(var r=0,i=0;i<e.lengths.length;i++){var n=e.lengths[i],s=e.coords[2*(0+r)],o=e.coords[2*(0+r)+1];ie.moveTo(s,o);for(var l=1;l<n;l++)s=e.coords[2*(l+r)],o=e.coords[2*(l+r)+1],ie.lineTo(s,o);ie.close(),r+=n}var u=ie.result(!1);if(!u)return null;var h,c=[],f=[],v=(0,a.Z)(u);try{for(v.s();!(h=v.n()).done;){var d,_=h.value,y=0,x=(0,a.Z)(_);try{for(x.s();!(d=x.n()).done;){var p=d.value;f.push(p.x),f.push(p.y),y++}}catch(m){x.e(m)}finally{x.f()}c.push(y)}}catch(m){v.e(m)}finally{v.f()}return new z.Z(c,f)}(i,r?256:8):null}}]),r}(e)},pe=r(98991),me=h.Z.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate"),ge=function(e){(0,x.Z)(r,e);var t=(0,p.Z)(r);function r(e){var i;return(0,s.Z)(this,r),(i=t.call(this))._ongoingMaterialRequestMap=new Map,i._materialCache=new Map,i._dynamicPropertyMap=new Map,i._cimLayer=e,i}return(0,o.Z)(r,[{key:"analyze",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t,r,n,a,s){var o,l,u,h,c,f,v,d,_,y,x,p,m,k,w=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s||0!==s.length){e.next=2;break}return e.abrupt("return",null);case 2:if(o=s&&s.length>0,l=r.readLegacyFeature(),u=r.getObjectId(),h=this._materialCache,c=this._cimLayer.materialHash){e.next=5;break}return e.abrupt("return",(me.error("A Dynamic mesh template must have a material hash value or function!"),null));case 5:if(f="function"==typeof c?c(l,n,a,u):c,null==(v=h.get(f))){e.next=8;break}return e.abrupt("return",v);case 8:if(!(d=this._ongoingMaterialRequestMap.get(f))){e.next=11;break}return e.abrupt("return",d);case 11:_=this._cimLayer,(y=(0,pe.S)(_.cim,this._cimLayer.materialOverrides)).mosaicHash=f,x=_.type,p=_.url,m={cim:y,type:x,mosaicHash:f,url:p,size:null,dashTemplate:null,text:null,fontName:null,objectId:u,animatedSymbolProperties:null},e.t0=x,e.next="marker"===e.t0?17:"line"===e.t0?19:"text"===e.t0?21:22;break;case 17:return m.size=(0,g.hf)(_.size,l,n,a),m.animatedSymbolProperties=(0,g.hf)(_.animatedSymbolProperties,l,n,a),e.abrupt("break",22);case 19:return m.dashTemplate=_.dashTemplate,e.abrupt("break",22);case 21:m.text=(0,g.hf)(_.text,l,n,a),m.fontName=(0,g.hf)(_.fontName,l,n,a);case 22:return k=t.getMosaicItem(m,s).then((function(e){return o||(w._ongoingMaterialRequestMap.delete(f),h.set(f,e)),e})).catch((function(e){return w._ongoingMaterialRequestMap.delete(f),me.error(".analyze()",e.message),null})),e.abrupt("return",(o||this._ongoingMaterialRequestMap.set(f,k),k));case 24:case"end":return e.stop()}}),e,this)})));return function(t,r,i,n,a){return e.apply(this,arguments)}}()}]),r}(_e.Z),ke=r(55940),we=function(e){(0,x.Z)(r,e);var t=(0,p.Z)(r);function r(e,i,n){var a,o;if((0,s.Z)(this,r),(o=t.call(this,e))._minMaxZoom=(0,M.UJ)(Math.round(i*w.MI),Math.round(n*w.MI)),(0,g.wO)(e.color)){o._dynamicPropertyMap.set("fillColor",(function(t,r,i){var n=e.color(t,r,i);return n&&(0,k.t2)(n)||0}))}else{var l=e.color;o.fillColor=l&&(0,k.t2)(l)||0}var u="CIMMarkerPlacementInsidePolygon"===(null===(a=e.cim.placement)||void 0===a?void 0:a.type)&&e.cim.placement.shiftOddRows?2:1,h=e.height;if((0,g.wO)(h)){o._dynamicPropertyMap.set("_height",(function(e,t,r){return h(e,t,r)*u}))}else o._height=(h||0)*u;var c=e.offsetX;if((0,g.wO)(c)){o._dynamicPropertyMap.set("_offsetX",(function(e,t,r){return(0,m.F2)(c(e,t,r))}))}else o._offsetX=(0,m.F2)(c||0);var f=e.offsetY;if((0,g.wO)(f)){o._dynamicPropertyMap.set("_offsetY",(function(e,t,r){return(0,m.F2)(-f(e,t,r))}))}else o._offsetY=(0,m.F2)(-f||0);var v=e.scaleX;(0,g.wO)(v)?o._dynamicPropertyMap.set("_scaleX",v):o._scaleX=v||1;var d=e.angle;if((0,g.wO)(d)){o._dynamicPropertyMap.set("_angle",(function(e,t,r){return(0,b.s5)(d(e,t,r))}))}else o._angle=(0,b.s5)(d)||0;if(null!=e.effects){var _=e.effects;(0,g.wO)(_)?o._dynamicPropertyMap.set("_effects",_):o._effects=_}return o._cimFillLayer=e,o._bitset=(e.colorLocked?w.Uh:0)|(e.applyRandomOffset?w.jk:0)|(e.sampleAlphaOnly?w.Iv:0)|(e.hasUnresolvedReplacementColor?w.vw:0),o._fillMaterialKey=e.materialKey,(0,y.Z)(o)}return(0,o.Z)(r,[{key:"bindFeature",value:function(e,t,r){var i=this,n=e.readLegacyFeature();this._dynamicPropertyMap.forEach((function(e,a){i[a]=e(n,t,r)}));var a=d.dk.load(this._fillMaterialKey),s=this._materialCache,o=(0,this._cimFillLayer.materialHash)(n,t,r),l=s.get(o),u=null;if(l&&(0,ke.ok)(l.spriteMosaicItem)&&(u=l.spriteMosaicItem),u){var h=u,c=h.rect,f=h.width,v=h.height,_=c.x+w.fL,y=c.y+w.fL,x=_+f,p=y+v,g=(0,m.F2)(this._height);g<=0&&(g=p-y),g<w.uQ&&(g*=w.Ls,this._bitset|=w.U),g=Math.round(g);var k=(0,m.F2)(this._height/v*f);k<=0&&(k=x-_),k<w.uQ&&(k*=w.Ls,this._bitset|=w.tz),k=Math.round(k);var b=this._scaleX;this.tl=(0,M.UJ)(_,y),this.br=(0,M.UJ)(x,p),this.aux21=(0,M.UJ)(k,g),this.aux22=(0,M.UJ)(this._offsetX,this._offsetY),this.aux3=(0,M.Jz)(b*w.Ls,1*w.Ls,this._angle,0),a.sdf=u.sdf,a.pattern=!0,a.textureBinding=u.textureBinding}else this.tl=0,this.br=0,this.aux21=0,this.aux22=0,this.aux3=0,a.sdf=!1,a.pattern=!1,a.textureBinding=0;this._materialKey=a.data}}],[{key:"fromCIMFill",value:function(e,t){var i=(0,Z._f)(e.scaleInfo,t),n=(0,_.Z)(i,2);return new r(e,n[0],n[1])}}]),r}(xe(ge)),be=function(e){(0,x.Z)(r,e);var t=(0,p.Z)(r);function r(e,i,n){var a;(0,s.Z)(this,r),(a=t.call(this,e))._minMaxZoom=(0,M.UJ)(Math.round(i*w.MI),Math.round(n*w.MI)),a._cimLineLayer=e;var o=0;(0,g.wO)(e.width)||(o=.5*(0,m.F2)(e.width));a._dynamicPropertyMap.set("_halfWidth",(function(t,r,i){return(0,g.wO)(e.width)?.5*(0,m.F2)(e.width(t,r,i)):o})),(0,g.wO)(e.cap)?a._dynamicPropertyMap.set("_capType",e.cap):a._capType=e.cap,(0,g.wO)(e.join)?a._dynamicPropertyMap.set("_joinType",e.join):a._joinType=e.join;var l=e.color;if((0,g.wO)(l)){a._dynamicPropertyMap.set("_fillColor",(function(e,t,r){return(0,k.t2)(l(e,t,r))}))}else a._fillColor=l&&(0,k.t2)(l)||0;var u=e.miterLimit;if((0,g.wO)(u)){a._dynamicPropertyMap.set("_miterLimitCosine",(function(e,t,r){return(0,Z.NW)(u(e,t,r))}))}else a._miterLimitCosine=(0,Z.NW)(u);if(null!=e.effects){var h=e.effects;(0,g.wO)(h)?a._dynamicPropertyMap.set("_effects",h):a._effects=h}a._scaleFactor=e.scaleFactor||1,a._isDashed=null!=e.dashTemplate;var c=e.colorLocked?w.Uh:0,f=e.scaleDash?w._6:0,v=e.sampleAlphaOnly?w.Iv:0;return a.tessellationProperties._bitset=c|f|v,a._materialKey=e.materialKey,a._initializeTessellator(!0),a}return(0,o.Z)(r,[{key:"bindFeature",value:function(e,t,r){var i=this,n=e.readLegacyFeature();this._dynamicPropertyMap.forEach((function(e,a){i[a]=e(n,t,r)})),this._halfWidth*=this._scaleFactor;var a=this._materialCache,s=(0,this._cimLineLayer.materialHash)(n,t,r),o=a.get(s),l=null;if(o&&(0,ke.ok)(o.spriteMosaicItem)&&(l=o.spriteMosaicItem),l){this._hasPattern=!0;var u=l,h=u.rect,c=u.width,f=u.height,v=h.x+w.fL,_=h.y+w.fL,y=v+c,x=_+f;this.tessellationProperties._tl=(0,M.UJ)(v,_),this.tessellationProperties._br=(0,M.UJ)(y,x)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor,this.tessellationProperties._halfWidth=this._halfWidth,this.tessellationProperties.offset=0,this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;var p=d.a.load(this._materialKey);l&&(p.sdf=l.sdf,p.pattern=!0,p.textureBinding=l.textureBinding),this._materialKey=p.data}}],[{key:"fromCIMLine",value:function(e,t){var i=(0,Z._f)(e.scaleInfo,t),n=(0,_.Z)(i,2);return new r(e,n[0],n[1])}}]),r}(ce(ge)),Me=r(11245),Ze=r(15245),Le=r(59697),Se=(0,Ze.c)(),Te=(0,Me.c)(),ze=function(e){(0,x.Z)(r,e);var t=(0,p.Z)(r);function r(e,i,n){var a,o;(0,s.Z)(this,r),(o=t.call(this,e))._cimMarkerLayer=e,o._minMaxZoom=(0,M.UJ)(Math.round(i*w.MI),Math.round(n*w.MI));var l=e.color;if((0,g.wO)(l)){o._dynamicPropertyMap.set("_fillColor",(function(e,t,r){return(0,k.t2)(l(e,t,r))}))}else o._fillColor=(0,k.t2)(l);var u=e.outlineColor;if((0,g.wO)(u)){o._dynamicPropertyMap.set("_outlineColor",(function(e,t,r){return(0,k.t2)(u(e,t,r))}))}else o._outlineColor=(0,k.t2)(u);var h=e.size;if((0,g.wO)(h)){o._dynamicPropertyMap.set("_size",(function(e,t,r){return(0,m.F2)(h(e,t,r))}))}else o._size=(0,m.F2)(h)||0;var c=e.scaleX;(0,g.wO)(c)?o._dynamicPropertyMap.set("_scaleX",c):o._scaleX=c;var f=e.offsetX;if((0,g.wO)(f)){o._dynamicPropertyMap.set("xOffset",(function(e,t,r){return(0,m.F2)(f(e,t,r))}))}else o.xOffset=(0,m.F2)(f)||0;var v=e.offsetY;if((0,g.wO)(v)){o._dynamicPropertyMap.set("yOffset",(function(e,t,r){return(0,m.F2)(v(e,t,r))}))}else o.yOffset=(0,m.F2)(v)||0;var d=e.outlineWidth;if((0,g.wO)(d)){o._dynamicPropertyMap.set("_outlineWidth",(function(e,t,r){return(0,m.F2)(d(e,t,r))}))}else o._outlineWidth=(0,m.F2)(d)||0;var _=e.rotation;if((0,g.wO)(_)?o._dynamicPropertyMap.set("_angle",_):o._angle=_||0,null!=e.effects){var y=e.effects;(0,g.wO)(y)?o._dynamicPropertyMap.set("_effects",y):o._effects=y}if(null!=e.markerPlacement){var x=e.markerPlacement;(0,g.wO)(x)?o._dynamicPropertyMap.set("_markerPlacement",x):o._markerPlacement=x}return o._scaleFactor=null!==(a=e.scaleFactor)&&void 0!==a?a:1,o._bitSet=(e.alignment===oe.v2.MAP?w.Tz:w.CQ)|(e.colorLocked?w.Uh:0)|(e.scaleSymbolsProportionally?w.e0:0),o._materialKey=e.materialKey,o}return(0,o.Z)(r,[{key:"bindFeature",value:function(e,t,r){var i=this,n=e.readLegacyFeature(),a=e.getObjectId();this._dynamicPropertyMap.forEach((function(e,a){i[a]=e(n,t,r)}));var s=this._cimMarkerLayer.materialHash,o="function"==typeof s?s(n,t,r,a):s,l=this._materialCache.get(o);if(l&&(0,ke.ok)(l.spriteMosaicItem)&&l.spriteMosaicItem){var c=l.spriteMosaicItem,f=this._cimMarkerLayer.sizeRatio,v=c.width/c.height*this._scaleX,_=d.mE.load(this._materialKey);_.sdf=c.sdf,_.pattern=!0,_.textureBinding=c.textureBinding,this._materialKey=_.data;var y=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,x=this._size,p=x*v,g=this.xOffset,k=this.yOffset;this.xOffset*=this._scaleFactor,this.yOffset*=this._scaleFactor;var w=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/(0,m.F2)(this._cimMarkerLayer.frameHeight):1,b=this._outlineWidth*w,Z=(0,m.F2)(this._cimMarkerLayer.referenceSize),L=0,S=0,T=this._cimMarkerLayer.anchorPoint;T&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(L=(0,m.F2)(T.x)/(this._size*v),S=(0,m.F2)(T.y)/this._size):(L=T.x,S=T.y)),this._anchorX=L,this._anchorY=S,this._sizeOutlineWidth=(0,M.Jz)(Math.round(Math.min(Math.sqrt(128*p),255)),Math.round(Math.min(Math.sqrt(128*x),255)),Math.round(Math.min(Math.sqrt(128*b),255)),Math.round(Math.min(Math.sqrt(128*Z),255))),this.angle=y;var z=Math.round(64*f);this._bitestAndDistRatio=(0,M.UJ)(this._bitSet,z),this._computeSize(p,x,f,b,this._scaleFactor,c,_.hasSizeVV(),!0),this._applyTransformation(Te,Se),this.xOffset=g,this.yOffset=k}else h.Z.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate").error(new u.Z("mapview-cim","Encountered an error when binding feature"))}}],[{key:"fromCIMMarker",value:function(e,t){var i=(0,Z._f)(e.scaleInfo,t),n=(0,_.Z)(i,2);return new r(e,n[0],n[1])}}]),r}((0,Le.Z)(ge)),We=r(11752),Pe=r(61120),Ie=r(38999),Ce=r(5748),Fe=r(27301);function Ee(e,t,r,i){var n;return"string"==typeof e.text?e.text:"function"==typeof e.text&&null!==(n=e.text(t,r,i))&&void 0!==n?n:""}var Ae=function(e){(0,x.Z)(r,e);var t=(0,p.Z)(r);function r(e,i,n){var a;(0,s.Z)(this,r),(a=t.call(this,e))._horizontalAlignment="center",a._verticalAlignment="middle",a._textToGlyphs=new Map,a._minMaxZoom=(0,M.UJ)(Math.round(i*w.MI),Math.round(n*w.MI));var o=e.scaleFactor||1;a._cimTextLayer=e;var l=e.color;if((0,g.wO)(l)){a._dynamicPropertyMap.set("_color",(function(e,t,r){return(0,k.t2)(l(e,t,r))}))}else a._color=(0,k.t2)(l);var u,h=e.outlineColor;if((0,g.wO)(h)){a._dynamicPropertyMap.set("_haloColor",(function(e,t,r){return(0,k.t2)(h(e,t,r))}))}else a._haloColor=(0,k.t2)(h);(0,g.wO)(e.size)||(u=Math.min(Math.round((0,m.F2)(e.size*e.sizeRatio)),127));var c;if(a._dynamicPropertyMap.set("_size",(function(t,r,i){return(0,g.wO)(e.size)?Math.min(Math.round((0,m.F2)(e.size(t,r,i)*e.sizeRatio)),127):u})),(0,g.wO)(e.outlineSize)){a._dynamicPropertyMap.set("_haloSize",(function(t,r,i){return Math.min(Math.floor(5*(0,m.F2)(e.outlineSize(t,r,i)*e.sizeRatio)),127)}))}else a._haloSize=Math.min(Math.floor(5*(0,m.F2)(e.outlineSize*e.sizeRatio)),127);(0,g.wO)(e.offsetX)||(c=Math.round((0,m.F2)(e.offsetX*e.sizeRatio)));var f;a._dynamicPropertyMap.set("_xOffset",(function(t,r,i){return(0,g.wO)(e.offsetX)?Math.round((0,m.F2)(e.offsetX(t,r,i)*e.sizeRatio)):c})),(0,g.wO)(e.offsetY)||(f=Math.round((0,m.F2)(e.offsetY*e.sizeRatio)));if(a._dynamicPropertyMap.set("_yOffset",(function(t,r,i){return(0,g.wO)(e.offsetY)?Math.round((0,m.F2)(e.offsetY(t,r,i)*e.sizeRatio)):f})),(0,g.wO)(e.angle)?a._dynamicPropertyMap.set("_angle",e.angle):a._angle=e.angle,(0,g.wO)(e.horizontalAlignment)?a._dynamicPropertyMap.set("_horizontalAlignment",e.horizontalAlignment):a._horizontalAlignment=e.horizontalAlignment,(0,g.wO)(e.verticalAlignment)?a._dynamicPropertyMap.set("_verticalAlignment",e.verticalAlignment):a._verticalAlignment=e.verticalAlignment,null!=e.effects){var v=e.effects;(0,g.wO)(v)?a._dynamicPropertyMap.set("_effects",v):a._effects=v}if(null!=e.markerPlacement){var _=e.markerPlacement;(0,g.wO)(_)?a._dynamicPropertyMap.set("_markerPlacement",_):a._textPlacement=_}(0,g.wO)(e.text)?a._dynamicPropertyMap.set("_text",e.text):a._text=e.text,a._backgroundColor=e.backgroundColor&&(0,k.t2)(e.backgroundColor),a._borderLineColor=e.borderLineColor&&(0,k.t2)(e.borderLineColor),a._borderLineSize=e.borderLineWidth,a._scaleFactor=o;var y=Math.min(Math.round((0,m.F2)(e.referenceSize*e.sizeRatio)),127);a._referenceSize=Math.round(Math.sqrt(256*y)),a._materialKey=e.materialKey;var x=d.qr.load(a._materialKey);return x.sdf=!0,a._bitset=(e.alignment===oe.v2.MAP?1:0)|(e.colorLocked?1:0)<<1,a._materialKey=x.data,a._decoration="none",a._lineHeight=1,a._lineWidth=512,a._isCIM=!0,a}return(0,o.Z)(r,[{key:"analyze",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t,n,a,s){var o,l,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.readLegacyFeature(),l=Ee(this._cimTextLayer,o,a,s),e.next=4,(0,We.Z)((0,Pe.Z)(r.prototype),"analyze",this).call(this,t,n,a,s,(0,Fe._)(l));case 4:return u=e.sent,e.abrupt("return",(u&&u.glyphMosaicItems&&this._textToGlyphs.set(l,u.glyphMosaicItems),u));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,i,n){return e.apply(this,arguments)}}()},{key:"bindFeature",value:function(e,t,r){var i,n,a,s=this,o=e.readLegacyFeature();if(this._dynamicPropertyMap.forEach((function(e,i){s[i]=e(o,t,r)})),this._text&&0!==this._text.length){this._size*=this._scaleFactor,this._scale=this._size/w.Ex,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=(0,Ie.kH)(null!==(i=this._horizontalAlignment)&&void 0!==i?i:"center"),this._yAlignD=(0,Ie.b7)(null!==(n=this._verticalAlignment)&&void 0!==n?n:"baseline");var l=null!==(a=this._textToGlyphs.get(this._text))&&void 0!==a?a:[];this.bindTextInfo(l,!1)}else this._shapingInfo=null}}],[{key:"fromCIMText",value:function(e,t){var i=(0,Z._f)(e.scaleInfo,t),n=(0,_.Z)(i,2);return new r(e,n[0],n[1])}}]),r}((0,Ce.Z)(ge)),Re=function(e){(0,x.Z)(r,e);var t=(0,p.Z)(r);function r(e,i,n,a,o,l,u,h,c,f,v,_,y,x,p,m){var g;(0,s.Z)(this,r),(g=t.call(this))._effects=x||void 0;var k=d.dk.load(e);return i&&(k.sdf=i.sdf,k.pattern=!0,k.textureBinding=i.textureBinding),g.fillColor=n,g.tl=a,g.br=o,g.aux21=(0,M.UJ)(l,u),g.aux22=(0,M.UJ)(h,c),g.aux3=(0,M.Jz)(f,v,_,0),g._bitset=y,g._minMaxZoom=(0,M.UJ)(Math.round(p*w.MI),Math.round(m*w.MI)),g._materialKey=k.data,g}return(0,o.Z)(r,null,[{key:"fromCIMFill",value:function(e,t,i){var n=e.color,a=n&&(0,k.t2)(n)||0,s=e.materialKey,o=(0,Z._f)(e.scaleInfo,i),l=(0,_.Z)(o,2),u=l[0],h=l[1],c=(e.colorLocked?w.Uh:0)|(e.applyRandomOffset?w.jk:0)|(e.sampleAlphaOnly?w.Iv:0)|(e.hasUnresolvedReplacementColor?w.vw:0);if(!t)return new r(s,null,a,0,0,0,0,0,0,0,0,0,c,e.effects,u,h);var f=t.rect,v=t.width,d=t.height,y=e.scaleX||1,x=f.x+w.fL,p=f.y+w.fL,g=x+v,L=p+d,S=(0,m.F2)(e.height),T=y*S;"CIMHatchFill"===e.cim.type&&(T*=v/d);var z=S;z<=0&&(z=L-p),z<w.uQ&&(z*=w.Ls,c|=w.U),z=Math.round(z);var W=T;W<=0&&(W=g-x),W<w.uQ&&(W*=w.Ls,c|=w.tz),W=Math.round(W);var P=(0,m.F2)(e.offsetX||0),I=(0,m.F2)(-e.offsetY||0);return new r(s,t,a,(0,M.UJ)(x,p),(0,M.UJ)(g,L),W,z,P,I,w.Ls,w.Ls,(0,b.s5)(e.angle),c,e.effects,u,h)}},{key:"fromSimpleFill",value:function(e,t){var i,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.color,s=a&&"esriSFSNull"!==e.style&&(0,k.aH)(a)||0,o=n?w.Uh:0,l=e.materialKey;if(t){var u=t.rect,h=t.width,c=t.height,f=t.pixelRatio,v=u.x+w.fL,d=u.y+w.fL,_=v+h,y=d+c,x=(0,M.UJ)(v,d),p=(0,M.UJ)(_,y),m=h/f;m<w.uQ&&(m*=w.Ls,o|=w.tz),m=Math.round(m);var g=c/f;g<w.uQ&&(g*=w.Ls,o|=w.U),i=new r(l,t,s,x,p,m,g=Math.round(g),0,0,w.Ls,w.Ls,0,o,null,Z.Xe,Z.eW)}else i=new r(l,null,s,0,0,0,0,0,0,0,0,0,o,null,Z.Xe,Z.eW);return i._maybeAddLineTemplate(e),i}},{key:"fromPictureFill",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=w.ru,a=t.rect,s=t.width,o=t.height,l=a.x+w.fL,u=a.y+w.fL,h=l+s,c=u+o,f=(0,M.UJ)(l,u),v=(0,M.UJ)(h,c),d=i?w.Uh:0,_=(0,m.F2)(e.width);_<w.uQ&&(_*=w.Ls,d|=w.tz),_=Math.round(_);var y=(0,m.F2)(e.height);y<w.uQ&&(y*=w.Ls,d|=w.U),y=Math.round(y);var x=(0,m.F2)(e.xoffset),p=(0,m.F2)(-e.yoffset),g=new r(e.materialKey,t,n,f,v,_,y,x,p,w.Ls*e.xscale,w.Ls*e.yscale,0,d,null,Z.Xe,Z.eW);return g._maybeAddLineTemplate(e),g}}]),r}(xe(_e.Z)),Be=r(64580),Oe=r(27344),Ve=function(){function e(){(0,s.Z)(this,e),this._resolver=null}return(0,o.Z)(e,[{key:"isHeld",value:function(){return!!this._resolver}},{key:"acquire",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._resolver){e.next=7;break}return e.next=3,this._resolver.promise;case 3:return e.next=5,this.acquire();case 5:e.next=8;break;case 7:this._resolver=(0,c.hh)();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"release",value:function(){var e=this._resolver;this._resolver=null,null===e||void 0===e||e.resolve()}}]),e}();function Ue(){return Ue=(0,n.Z)((0,i.Z)().mark((function e(t,r,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.acquire();case 3:return e.next=5,r(n);case 5:t.release(),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),t.release(),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),Ue.apply(this,arguments)}var De=r(98125),Ge=h.Z.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),Ke={sortKey:null,templates:new Array},Ne={isOutline:!1,placement:null,symbologyType:v.mD.DEFAULT,vvFlags:0},Je=(0,l.Z)((0,l.Z)({},f.eG),{},{hash:JSON.stringify(f.eG),materialKey:(0,d.jj)(v.LW.MARKER,Ne)}),Xe=(0,l.Z)((0,l.Z)({},f.wW),{},{hash:JSON.stringify(f.wW),materialKey:(0,d.jj)(v.LW.LINE,Ne)}),He=(0,l.Z)((0,l.Z)({},f.lj),{},{hash:JSON.stringify(f.lj),materialKey:(0,d.jj)(v.LW.FILL,Ne)});function Ye(e,t){var r=e.length;return e.push(null),t.then((function(t){return e[r]=t})),e}function qe(e){return null!=e&&!!(1&e)}var je=function(){function e(t,r){(0,s.Z)(this,e),this._idCounter=1,this._templateIdCounter=1,this._idToTemplateGroup=new Map,this._symbolToTemplate=new Map,this._fetchQueue=[],this._idToResolver=new Map,this._cimTemplateCache=new Map,this._cimAnalyses=[],this._lock=new Ve,this._fetchResource=t,this._tileInfo=r}return(0,o.Z)(e,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}},{key:"createTemplateGroup",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._initErrorTemplates();var i=e.hash,n=this._symbolToTemplate.get(i);if(null!=n)return n;var a=new Array,s={sortKey:r,templates:a};t&&this._createMeshTemplates(a,t,!0),this._createMeshTemplates(a,e,!1);var o=this._createGroupId("expanded-cim"===e.type&&Qe(e));return this._idToTemplateGroup.set(o,s),this._symbolToTemplate.set(i,o),o}},{key:"getTemplateGroup",value:function(e){var t;return null!==(t=this._idToTemplateGroup.get(e))&&void 0!==t?t:Ke}},{key:"getDynamicTemplateGroup",value:function(e){return this._idToTemplateGroup.has(e)?(qe(e)||Ge.error("mapview-template-store","Id ".concat(e," does not refer to a dynamic template")),this._idToTemplateGroup.get(e)):Ke}},{key:"getMosaicItem",value:function(e,t){var r=this,i=this._createTemplateId(),n=new Promise((function(e){return r._idToResolver.set(i,e)}));return this._fetchQueue.push({symbol:e,id:i,glyphIds:t}),n}},{key:"finalize",value:function(e){return this._fetchQueue.length||this._lock.isHeld()?function(e,t,r){return Ue.apply(this,arguments)}(this._lock,this._fetchAllQueuedResources.bind(this),e):Promise.resolve()}},{key:"_initErrorTemplates",value:function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],He,!1),marker:this._createMeshTemplates([],Je,!1),line:this._createMeshTemplates([],Xe,!1)})}},{key:"_fetchAllQueuedResources",value:function(e){var t=this;if(!this._fetchQueue.length)return Promise.resolve();var r=this._fetchQueue,i=this._cimAnalyses;return this._fetchQueue=[],this._cimAnalyses=[],Promise.all(i).then((function(){return t._fetchResource(r,e).then((function(e){var r,i=(0,a.Z)(e);try{for(i.s();!(r=i.n()).done;){var n=r.value,s=n.id,o=n.mosaicItem;t._idToResolver.get(s)(o),t._idToResolver.delete(s)}}catch(l){i.e(l)}finally{i.f()}}))})).catch((function(e){(0,c.D_)(e)?t._fetchQueue=t._fetchQueue.concat(r):"worker:port-closed"===e.name||Ge.error(new u.Z("mapview-template-store","Unable to fetch requested texture resources",e))}))}},{key:"_createGroupId",value:function(e){return this._idCounter++<<1|(e?1:0)}},{key:"_createTemplateId",value:function(){return this._templateIdCounter++}},{key:"_createSMS",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t){var r,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",(0,ke.ok)(n,Ge)?Be.Z.fromSimpleMarker(t,n):this._markerError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createPMS",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t){var r,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",(0,ke.ok)(n,Ge)?Be.Z.fromPictureMarker(t,n):this._markerError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createSFS",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t,r){var n,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return n=e.sent,a=n.spriteMosaicItem,e.abrupt("return",(0,ke.ok)(a,Ge)?Re.fromSimpleFill(t,a,r):this._fillError);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createPFS",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t,r){var n,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return n=e.sent,a=n.spriteMosaicItem,e.abrupt("return",(0,ke.ok)(a,Ge)?Re.fromPictureFill(t,a,r):this._fillError);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createSLS",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t,r){var n,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return n=e.sent,a=n.spriteMosaicItem,e.abrupt("return",(0,ke.ok)(a,Ge)?ye.fromSimpleLine(t,a):this._lineError);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createLMS",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t){var r,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",(0,ke.ok)(n,Ge)?Be.Z.fromLineSymbolMarker(t,n):this._markerError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createTS",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t){var r,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.glyphMosaicItems,e.abrupt("return",Oe.Z.fromText(t,null!==n&&void 0!==n?n:[]));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMText",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t){var r,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem((0,De.x)(t),(0,Fe._)(t.text));case 2:return r=e.sent,n=r.glyphMosaicItems,e.abrupt("return",(0,ke.ok)(n,Ge)?Oe.Z.fromCIMText(t,n,this._tileInfo):this._textError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMFill",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t){var r,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem((0,De.x)(t));case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",(0,ke.ok)(n,Ge)?Re.fromCIMFill(t,n,this._tileInfo):this._fillError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMLine",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t){var r,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem((0,De.x)(t));case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",(0,ke.ok)(n,Ge)?ye.fromCIMLine(t,n,this._tileInfo):this._lineError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMMarker",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t){var r,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem((0,De.x)(t));case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",(0,ke.ok)(n,Ge)?Be.Z.fromCIMMarker(t,n,this._tileInfo):this._markerError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIM",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t){var r,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.templateHash,null==(n=this._cimTemplateCache.get(r))){e.next=4;break}return e.abrupt("return",n);case 4:e.t0=t.type,e.next="marker"===e.t0?7:"line"===e.t0?11:"fill"===e.t0?15:"text"===e.t0?19:22;break;case 7:return e.next=9,this._createCIMMarker(t);case 9:return n=e.sent,e.abrupt("break",22);case 11:return e.next=13,this._createCIMLine(t);case 13:return n=e.sent,e.abrupt("break",22);case 15:return e.next=17,this._createCIMFill(t);case 17:return n=e.sent,e.abrupt("break",22);case 19:return e.next=21,this._createCIMText(t);case 21:n=e.sent;case 22:return e.abrupt("return",(this._cimTemplateCache.set(r,n),n));case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createDynamicCIM",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t){var r,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.templateHash,null==(n=this._cimTemplateCache.get(r))){e.next=4;break}return e.abrupt("return",n);case 4:e.t0=t.type,e.next="marker"===e.t0?7:"line"===e.t0?9:"fill"===e.t0?11:"text"===e.t0?13:14;break;case 7:return n=ze.fromCIMMarker(t,this._tileInfo),e.abrupt("break",14);case 9:return n=be.fromCIMLine(t,this._tileInfo),e.abrupt("break",14);case 11:return n=we.fromCIMFill(t,this._tileInfo),e.abrupt("break",14);case 13:n=Ae.fromCIMText(t,this._tileInfo);case 14:return e.abrupt("return",(this._cimTemplateCache.set(r,n),n));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createPrimitiveMeshTemplates",value:function(e,t,r){switch(t.type){case"esriSMS":return Ye(e,this._createSMS(t));case"esriPMS":return Ye(e,this._createPMS(t));case"esriSFS":return Ye(e,this._createSFS(t,r));case"line-marker":return Ye(e,this._createLMS(t));case"esriPFS":return Ye(e,this._createPFS(t,r));case"esriSLS":return Ye(e,this._createSLS(t,!1));case"esriTS":return Ye(e,this._createTS(t));default:return Ge.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),e}}},{key:"_createMeshTemplates",value:function(e,t,r){if(t.type.includes("3d"))return Ge.error("3D symbols are not supported with MapView"),e;if("expanded-cim"===t.type){var i,n=(0,a.Z)(t.layers);try{for(n.s();!(i=n.n()).done;){var s=i.value;"function"==typeof s.materialHash?Ye(e,this._createDynamicCIM(s)):Ye(e,this._createCIM(s))}}catch(h){n.e(h)}finally{n.f()}return e}if("composite-symbol"===t.type){var o,l=(0,a.Z)(t.layers);try{for(l.s();!(o=l.n()).done;){var u=o.value;this._createPrimitiveMeshTemplates(e,u,r)}}catch(h){l.e(h)}finally{l.f()}return e}return"cim"===t.type||"label"===t.type||"web-style"===t.type?e:this._createPrimitiveMeshTemplates(e,t,r)}}]),e}(),Qe=function(e){if(!e.layers)return!1;var t,r=(0,a.Z)(e.layers);try{for(r.s();!(t=r.n()).done;){if("function"==typeof t.value.materialHash)return!0}}catch(i){r.e(i)}finally{r.f()}return!1}},27344:function(e,t,r){r.d(t,{Z:function(){return m}});var i=r(29439),n=r(15671),a=r(43144),s=r(60136),o=r(29388),l=r(75746),u=r(17842),h=r(48202),c=r(38999),f=r(65800),v=r(94109),d=r(73271),_=r(54815),y=r(42093),x=r(5748),p=r(52993),m=function(e){(0,s.Z)(r,e);var t=(0,o.Z)(r);function r(e,i,a,s,o,l,f,y,x,p,m,g,k,w,b,M,Z,L,S,T,z,W,P,I){var C;(0,n.Z)(this,r),(C=t.call(this))._xOffset=(0,u.F2)(k),C._yOffset=(0,u.F2)(w),C._decoration=p||"none",C._backgroundColor=W,C._borderLineColor=P,C._borderLineSize=I,C._color=o,C._haloColor=l,C._haloSize=Math.min(Math.floor(5*(0,u.F2)((0,u.t_)(a))),127),C._size=Math.min(Math.round((0,u.F2)(i)),127);var F=Math.min(Math.round((0,u.F2)(s||i)),127);C._referenceSize=Math.round(Math.sqrt(256*F)),C._scale=C._size/v.Ex,C._angle=g,C._justify=(0,c.Hd)(f||"center"),C._xAlignD=(0,c.kH)(f||"center"),C._yAlignD=(0,c.b7)(y||"baseline"),C._baseline="baseline"===(y||"baseline"),C._bitset=(x===h.v2.MAP?1:0)|(m?1:0)<<1;var E=_.m2.load(e);return E.sdf=!0,C._materialKey=E.data,C._lineWidth=(0,u.F2)(b)||512,C._lineHeight=M||1,C._textPlacement=Z,C._effects=L,C._isCIM=null!==S&&void 0!==S&&S,C._minMaxZoom=(0,d.UJ)(Math.round(T*v.MI),Math.round(z*v.MI)),C}return(0,a.Z)(r,null,[{key:"fromText",value:function(e,t){var n,a,s=null===(n=e.font)||void 0===n?void 0:n.size,o=new r(e.materialKey,s,e.haloSize||0,s,e.color&&(0,f.aH)(e.color)||0,e.haloColor&&(0,f.aH)(e.haloColor)||0,e.horizontalAlignment,e.verticalAlignment,h.v2.SCREEN,null===(a=e.font)||void 0===a?void 0:a.decoration,!1,e.angle||0,e.xoffset||0,e.yoffset||0,e.lineWidth||0,e.lineHeight||0,null,null,!1,y.Xe,y.eW,e.backgroundColor&&(0,f.aH)(e.backgroundColor),e.borderLineColor&&(0,f.aH)(e.borderLineColor),e.borderLineSize),u=(0,l.E)(e.text),c=(0,i.Z)(u,2)[1];return o.bindTextInfo(null!==t&&void 0!==t?t:[],c),o._vertexBoundsScale=e.maxVVSize&&s?e.maxVVSize/s:1,o}},{key:"fromCIMText",value:function(e,t,n){var a,s=e.scaleFactor||1,o=e.size*e.sizeRatio*s,u=(0,y._f)(e.scaleInfo,n),h=(0,i.Z)(u,2),c=h[0],v=h[1],d=new r(e.materialKey,o,e.outlineSize*e.sizeRatio,e.referenceSize,(0,f.t2)(e.color),(0,f.t2)(e.outlineColor),e.horizontalAlignment,e.verticalAlignment,e.alignment,e.decoration,null!==(a=e.colorLocked)&&void 0!==a&&a,e.angle,e.offsetX*e.sizeRatio*s,e.offsetY*e.sizeRatio*s,512,1,e.markerPlacement,e.effects,!0,c,v,e.backgroundColor?(0,f.t2)(e.backgroundColor):void 0,e.borderLineColor?(0,f.t2)(e.borderLineColor):void 0,e.borderLineWidth),_=(0,l.E)(e.text),x=(0,i.Z)(_,2)[1];return d.bindTextInfo(t,x),d._vertexBoundsScale=e.maxVVSize?e.maxVVSize/o:1,d}}]),r}((0,x.Z)(p.Z))},42093:function(e,t,r){r.d(t,{Fv:function(){return o},NW:function(){return u},TK:function(){return l},Xe:function(){return i},_f:function(){return h},eW:function(){return n},lu:function(){return a}});var i=0,n=100;function a(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function s(e,t){return Math.sqrt(e*e+t*t)}function o(e){var t=s(e[0],e[1]);e[0]/=t,e[1]/=t}function l(e,t){return s(e[0]-t[0],e[1]-t[1])}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return 1/Math.max(e,1)}function h(e,t){return[!(null===e||void 0===e||!e.minScale)&&t.scaleToZoom(e.minScale)||i,!(null===e||void 0===e||!e.maxScale)&&t.scaleToZoom(e.maxScale)||n]}},69813:function(e,t,r){r.d(t,{fL:function(){return w}});var i=r(29439),n=r(1413),a=r(37762),s=r(11752),o=r(61120),l=r(60136),u=r(29388),h=r(74165),c=r(15671),f=r(43144),v=r(15861),d=r(63780),_=r(10064),y=r(32718),x=r(16054),p=r(819),m=r(91935),g=r(98125),k=y.Z.getLogger("esri/views/2d/engine/webgl/util/Matcher");function w(e,t,r,i){return b.apply(this,arguments)}function b(){return(b=(0,v.Z)((0,h.Z)().mark((function e(t,r,i,n){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="simple"===e.t0||"heatmap"===e.t0?3:"map"===e.t0?4:"interval"===e.t0?5:"dictionary"===e.t0?6:"pie-chart"===e.t0?7:"subtype"===e.t0?8:9;break;case 3:return e.abrupt("return",Z.fromBasicRenderer(t,r,i,n));case 4:return e.abrupt("return",T.fromUVRenderer(t,r,i,n));case 5:return e.abrupt("return",S.fromCBRenderer(t,r,i,n));case 6:return e.abrupt("return",C.fromDictionaryRenderer(t,r,i,n));case 7:return e.abrupt("return",L.fromPieChartRenderer(t,r,i,n));case 8:return e.abrupt("return",L.fromSubtypes(t,r,i,n));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M,Z=function(){function e(){(0,c.Z)(this,e),this.type="feature",this._defaultResult=null}return(0,f.Z)(e,[{key:"size",value:function(){return 1}},{key:"getDefault",value:function(){return this._defaultResult}},{key:"setDefault",value:function(e){this._defaultResult=e}},{key:"match",value:function(e,t,r,i,n){return this.getDefault()}},{key:"analyze",value:function(){var e=(0,v.Z)((0,h.Z)().mark((function e(t,r,i,n,a,s){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)})));return function(t,r,i,n,a,s){return e.apply(this,arguments)}}()}],[{key:"fromBasicRenderer",value:function(){var t=(0,v.Z)((0,h.Z)().mark((function t(r,i,n,a){var s,o,l;return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=new e,!r.symbol){t.next=7;break}return t.next=4,(0,g.B)(r.symbol,n,a);case 4:o=t.sent,l=i.createTemplateGroup(o,null),s.setDefault(l);case 7:return t.abrupt("return",s);case 8:case"end":return t.stop()}}),t)})));return function(e,r,i,n){return t.apply(this,arguments)}}()},{key:"fromPieChartRenderer",value:function(){var t=(0,v.Z)((0,h.Z)().mark((function t(r,i,n,a){var s,o,l,u;return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=new e,!r.markerSymbol){t.next=12;break}return t.next=4,(0,g.B)(r.markerSymbol,n,a);case 4:if(o=t.sent,t.t0=r.fillSymbol,!t.t0){t.next=10;break}return t.next=9,(0,g.B)(r.fillSymbol,n,a);case 9:l=t.sent;case 10:u=i.createTemplateGroup(o,l),s.setDefault(u);case 12:return t.abrupt("return",s);case 13:case"end":return t.stop()}}),t)})));return function(e,r,i,n){return t.apply(this,arguments)}}()}]),e}(),L=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(e,i){var n;return(0,c.Z)(this,r),(n=t.call(this))._subMatchers=e,n._subtypeField=i,n}return(0,f.Z)(r,[{key:"match",value:function(e,t,r,i,n){var a=t.readAttribute(this._subtypeField),s=this._subMatchers.get(a);return s?s.match(e,t,r,i,n):null}}],[{key:"fromSubtypes",value:function(){var e=(0,v.Z)((0,h.Z)().mark((function e(t,i,n,a){var s,o,l,u;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=new Map,o=[],l=(0,h.Z)().mark((function e(){var r,l;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=parseInt(u,10),l=w(t.renderers[u],i,n,a).then((function(e){return s.set(r,e)})),o.push(l);case 2:case"end":return e.stop()}}),e)})),e.t0=(0,h.Z)().keys(t.renderers);case 3:if((e.t1=e.t0()).done){e.next=8;break}return u=e.t1.value,e.delegateYield(l(),"t2",6);case 6:e.next=3;break;case 8:return e.next=10,Promise.all(o);case 10:return e.abrupt("return",new r(s,t.subtypeField));case 11:case"end":return e.stop()}}),e)})));return function(t,r,i,n){return e.apply(this,arguments)}}()}]),r}(Z),S=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(e,i,n,a){var s;return(0,c.Z)(this,r),(s=t.call(this)).type="interval",s._intervals=[],s._isMaxInclusive=i,s._fieldIndex=a,s._field=e,s._normalizationInfo=n,s}return(0,f.Z)(r,[{key:"add",value:function(e,t){this._intervals.push({interval:e,result:t}),this._intervals.sort((function(e,t){return e.interval.min-t.interval.min}))}},{key:"size",value:function(){return(0,s.Z)((0,o.Z)(r.prototype),"size",this).call(this)+this._intervals.length}},{key:"match",value:function(e,t,r,i,n){if(null==this._fieldIndex&&!this._field)return this.getDefault();var a=null!=this._fieldIndex?t.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(t);if(null==a||isNaN(a)||a===1/0||a===-1/0)return this.getDefault();for(var s=0;s<this._intervals.length;s++){var o=this._intervals[s],l=o.interval,u=o.result,h=a>=l.min,c=this._isMaxInclusive?a<=l.max:a<l.max;if(h&&c)return u}return this.getDefault()}},{key:"_needsNormalization",value:function(){var e=this._normalizationInfo;return e&&(e.normalizationField||e.normalizationTotal||e.normalizationType)}},{key:"_getValueFromField",value:function(e){var t,r=e.readAttribute(this._field);if(!this._needsNormalization()||null==r)return r;var i=this._normalizationInfo,n=i.normalizationField,a=i.normalizationTotal,s=i.normalizationType,o=null!==(t=e.readAttribute(n))&&void 0!==t?t:1;if(s)switch(s){case"esriNormalizeByField":return o?r/o:void 0;case"esriNormalizeByLog":return Math.log(r)*Math.LOG10E;case"esriNormalizeByPercentOfTotal":return r/a*100;default:return void k.error("Found unknown normalization type: ".concat(s))}else k.error("Normalization is required, but no type was set!")}}],[{key:"fromCBRenderer",value:function(){var e=(0,v.Z)((0,h.Z)().mark((function e(t,i,n,a){var s,o,l,u,c,f,d,_,y;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.isMaxInclusive,o=t.normalizationField,l=t.normalizationTotal,u=t.normalizationType,c=t.field,f=new r(c,s,{normalizationField:o,normalizationTotal:l,normalizationType:u},t.fieldIndex),e.next=8,(0,g.B)(t.backgroundFillSymbol,n,a);case 8:return d=e.sent,e.next=11,Promise.all(t.intervals.map(function(){var e=(0,v.Z)((0,h.Z)().mark((function e(t){var r,s,o;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.B)(t.symbol,n,a);case 2:return r=e.sent,e.next=5,i.createTemplateGroup(r,d);case 5:s=e.sent,o={min:t.min,max:t.max},f.add(o,s);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:return e.next=13,(0,g.B)(t.defaultSymbol,n,a);case 13:if(!(_=e.sent)){e.next=19;break}return e.next=17,i.createTemplateGroup(_,d);case 17:y=e.sent,f.setDefault(y);case 19:return e.abrupt("return",f);case 20:case"end":return e.stop()}}),e)})));return function(t,r,i,n){return e.apply(this,arguments)}}()}]),r}(Z),T=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(e,i,n){var a;return(0,c.Z)(this,r),(a=t.call(this)).type="map",a._nullResult=null,a._resultsMap=new Map,a._fields=[],a._fieldsIndex=n,a._fields=e,a._seperator=i||"",a}return(0,f.Z)(r,[{key:"setNullResult",value:function(e){this._nullResult=e}},{key:"add",value:function(e,t){this._resultsMap.set(e.toString(),t)}},{key:"size",value:function(){return(0,s.Z)((0,o.Z)(r.prototype),"size",this).call(this)+this._resultsMap.size}},{key:"match",value:function(e,t,r,i,n){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();var a=null!=this._fieldsIndex?t.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(t);if(null!==this._nullResult&&(null==a||""===a||"<Null>"===a))return this._nullResult;if(null==a)return this.getDefault();var s=a.toString();return this._resultsMap.has(s)?this._resultsMap.get(s):this.getDefault()}},{key:"_getValueFromFields",value:function(e){var t,r=[],i=(0,a.Z)(this._fields);try{for(i.s();!(t=i.n()).done;){var n=t.value,s=e.readAttribute(n);null==s||""===s?r.push("<Null>"):r.push(s)}}catch(o){i.e(o)}finally{i.f()}return r.join(this._seperator)}}],[{key:"fromUVRenderer",value:function(){var e=(0,v.Z)((0,h.Z)().mark((function e(t,i,n,a){var s,o,l,u,c,f,d;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.fieldDelimiter,o=[t.field],t.field2&&o.push(t.field2),t.field3&&o.push(t.field3),e.next=4,(0,g.B)(t.backgroundFillSymbol,n,a);case 4:return l=e.sent,u=new r(o,s,t.fieldIndex),e.next=8,Promise.all(t.map.map(function(){var e=(0,v.Z)((0,h.Z)().mark((function e(t,r){var s,o,c;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.B)(t.symbol,n,a);case 2:return s=e.sent,o=r+1,e.next=6,i.createTemplateGroup(s,l,o);case 6:c=e.sent,"<Null>"===t.value?u.setNullResult(c):u.add(t.value,c);case 8:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()));case 8:return e.next=10,(0,g.B)(t.defaultSymbol,n,a);case 10:if(!(c=e.sent)){e.next=17;break}return f=Number.MAX_SAFE_INTEGER,e.next=15,i.createTemplateGroup(c,l,f);case 15:d=e.sent,u.setDefault(d);case 17:return e.abrupt("return",u);case 18:case"end":return e.stop()}}),e)})));return function(t,r,i,n){return e.apply(this,arguments)}}()}]),r}(Z);function z(e,t){return W.apply(this,arguments)}function W(){return(W=(0,v.Z)((0,h.Z)().mark((function e(t,r){var i,n;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("number"!=typeof(i=t||1)){e.next=3;break}return e.abrupt("return",(function(e,t,r){return i}));case 3:return e.next=5,(0,p.Yi)(i,r.spatialReference,r.fields);case 5:return n=e.sent,e.abrupt("return",(function(e,t,i){return(0,m.Z)(n,e,{$view:i},r.geometryType,t)||1}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return I.apply(this,arguments)}function I(){return(I=(0,v.Z)((0,h.Z)().mark((function e(){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(M||(M=r.e(5164).then(r.bind(r,85164))),M));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var C=function(e){(0,l.Z)(s,e);var t=(0,u.Z)(s);function s(e,r,i,n,a,o){var l;return(0,c.Z)(this,s),(l=t.call(this)).type="dictionary",l._groupIdCache=new x.z(100),l._loader=e,l._fieldMap=e.fieldMap,l._symbolFields=e.getSymbolFields(),l._templates=r,l._info=i,l._scaleFn=n,l._schemaUtilsModule=a,l._symbolOptions=o,l}return(0,f.Z)(s,[{key:"_analyzeFeature",value:function(){var e=(0,v.Z)((0,h.Z)().mark((function e(t,r,i,s,o){var l,u,c,f,v,d,y,x,p=this;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=t.readLegacyFeature(),u=this._scaleFn(l,i,s),c=this._attributeHash(l)+"-"+u,!(f=this._groupIdCache.get(c))){e.next=3;break}return e.abrupt("return",f);case 3:return v=(0,n.Z)((0,n.Z)({},s),{},{spatialReference:this._info.spatialReference,abortOptions:o,fields:this._info.fields}),e.next=6,this._loader.getSymbolAsync(l,v);case 6:return d=e.sent,y=this._schemaUtilsModule.createSymbolSchema(d,this._symbolOptions),x=(0,g.B)(y,this._info,r,o).then((function(e){if("expanded-cim"!==(null===e||void 0===e?void 0:e.type))return k.error(new _.Z("mapview-bad-type","Found unexpected type ".concat(null===e||void 0===e?void 0:e.type," in dictionary response"))),null;e.hash+="-"+u;var t,r=(0,a.Z)(e.layers);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.scaleFactor=u,i.templateHash+="-"+u}}catch(n){r.e(n)}finally{r.f()}return p._templates.createTemplateGroup(e,null)})),e.abrupt("return",(this._groupIdCache.put(c,x,1),x));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,i,n,a){return e.apply(this,arguments)}}()},{key:"analyze",value:function(){var e=(0,v.Z)((0,h.Z)().mark((function e(t,r,i,n,a,s){var o,l;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=r.getCursor(),l=[];o.next();)l.push(this._analyzeFeature(o,i,n,a,s));return e.abrupt("return",Promise.all(l).then((function(e){return e.filter(d.pC)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,i,n,a,s){return e.apply(this,arguments)}}()},{key:"match",value:function(e,t,r,i,n){return null}},{key:"_attributeHash",value:function(e){var t,r="",i=(0,a.Z)(this._symbolFields);try{for(i.s();!(t=i.n()).done;){var n,s=t.value,o=null===(n=this._fieldMap)||void 0===n?void 0:n[s];o&&(r+=e.attributes[o]+"-")}}catch(l){i.e(l)}finally{i.f()}return r}}],[{key:"fromDictionaryRenderer",value:function(){var e=(0,v.Z)((0,h.Z)().mark((function e(t,n,a,o){var l,u,c,f,v,d;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Promise.resolve().then(r.bind(r,75465)),P()]);case 2:return l=e.sent,u=(0,i.Z)(l,2),c=u[0].DictionaryLoader,f=u[1],v=new c(t.url,t.config,t.fieldMap),e.next=9,v.fetchResources({spatialReference:a.spatialReference,fields:a.fields});case 9:return e.next=11,z(t.scaleExpression,a);case 11:return d=e.sent,e.abrupt("return",new s(v,n,a,d,f,t.symbolOptions));case 13:case"end":return e.stop()}}),e)})));return function(t,r,i,n){return e.apply(this,arguments)}}()}]),s}(Z)},55940:function(e,t,r){r.d(t,{ok:function(){return n}});var i=r(10064);function n(e,t){if(e&&"name"in e){var r=e;return t&&t.error(new i.Z(r.name,r.message,r.details)),!1}return!0}},27446:function(e,t,r){r.d(t,{Z:function(){return s}});var i=r(93433),n=r(15671),a=r(43144),s=function(){function e(t,r){(0,n.Z)(this,e),this._pos=0;var i=r?this._roundToNearest(r,t.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(i),this._buffer=new t(this._array),this._ctor=t,this._i16View=new Int16Array(this._array)}return(0,a.Z)(e,[{key:"length",get:function(){return this._pos}},{key:"_roundToNearest",value:function(e,t){var r=Math.round(e);return 1===t?r:r+(t-r%t)}},{key:"_ensureSize",value:function(e){if(this._pos+e>=this._buffer.length){var t=this._roundToNearest(1.25*(this._array.byteLength+e*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT),r=new ArrayBuffer(t),i=new this._ctor(r);i.set(this._buffer,0),this._array=r,this._buffer=i,this._i16View=new Int16Array(this._array)}}},{key:"ensureSize",value:function(e){this._ensureSize(e)}},{key:"writeF32",value:function(e){this._ensureSize(1);var t=this._pos;return new Float32Array(this._array,4*this._pos,1)[0]=e,this._pos++,t}},{key:"push",value:function(e){this._ensureSize(1);var t=this._pos;return this._buffer[this._pos++]=e,t}},{key:"writeFixed",value:function(e){this._buffer[this._pos++]=e}},{key:"setValue",value:function(e,t){this._buffer[e]=t}},{key:"i1616Add",value:function(e,t,r){this._i16View[2*e]+=t,this._i16View[2*e+1]+=r}},{key:"getValue",value:function(e){return this._buffer[e]}},{key:"incr",value:function(e){if(this._buffer.length<e)throw new Error("Increment index overflows the target buffer");this._buffer[e]++}},{key:"decr",value:function(e){this._buffer[e]--}},{key:"writeRegion",value:function(e){this._ensureSize(e.length);var t=this._pos;return this._buffer.set(e,this._pos),this._pos+=e.length,t}},{key:"writeManyFrom",value:function(e,t,r){this._ensureSize(r-t);for(var i=t;i!==r;i++)this.writeFixed(e._buffer[i])}},{key:"buffer",value:function(){var e=this._array.slice(0,4*this._pos);return this.destroy(),e}},{key:"toArray",value:function(){return(0,i.Z)(this._buffer)}},{key:"seek",value:function(e){this._pos=e}},{key:"destroy",value:function(){this._array=null,this._buffer=null}}]),e}()},35092:function(e,t,r){function i(e,t,r,i){var n=e.clone(),a=1<<n.level,s=n.col+t,o=n.row+r;return i&&s<0?(n.col=s+a,n.world-=1):s>=a?(n.col=s-a,n.world+=1):n.col=s,n.row=o,n}r.d(t,{M:function(){return i}})},27301:function(e,t,r){function i(e){if(null==e)return[];for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}r.d(t,{_:function(){return i}})}}]);
//# sourceMappingURL=9484.cccef9fb.chunk.js.map