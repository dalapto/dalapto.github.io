{"version":3,"file":"static/js/1231.5bba749c.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/support/ExportImageParameters.js","../node_modules/@arcgis/core/views/2d/layers/MapImageLayerView2D.js","../node_modules/@arcgis/core/views/layers/MapImageLayerView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Accessor.js\";import{HandleOwnerMixin as s}from\"../../core/HandleOwner.js\";import{sqlAnd as t}from\"../../core/sql.js\";import{property as i}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as a}from\"./commonProperties.js\";import{getLayerFloorFilterClause as l}from\"./floorFilterUtils.js\";import{isExportDynamic as n}from\"./sublayerUtils.js\";const y={visible:\"visibleSublayers\",definitionExpression:\"layerDefs\",labelingInfo:\"hasDynamicLayers\",labelsVisible:\"hasDynamicLayers\",opacity:\"hasDynamicLayers\",minScale:\"visibleSublayers\",maxScale:\"visibleSublayers\",renderer:\"hasDynamicLayers\",source:\"hasDynamicLayers\"};let m=class extends(s(r)){constructor(e){super(e),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map((e=>{const r=l(this.floors,e);return e.toExportImageJSON(r)}));return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&n(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(e){this._get(\"layer\")!==e&&(this._set(\"layer\",e),this.handles.remove(\"layer\"),e&&this.handles.add([e.allSublayers.on(\"change\",(()=>this.notifyChange(\"visibleSublayers\"))),e.on(\"sublayer-update\",(e=>this.notifyChange(y[e.propertyName])))],\"layer\"))}get layers(){const e=this.visibleSublayers;return e?e.length?\"show:\"+e.map((e=>e.id)).join(\",\"):\"show:-1\":null}get layerDefs(){const e=!!this.floors?.length,r=this.visibleSublayers.filter((r=>null!=r.definitionExpression||e&&null!=r.floorInfo));return r.length?JSON.stringify(r.reduce(((e,r)=>{const s=l(this.floors,r),i=t(s,r.definitionExpression);return null!=i&&(e[r.id]=i),e}),{})):null}get version(){this.commitProperty(\"layers\"),this.commitProperty(\"layerDefs\"),this.commitProperty(\"dynamicLayers\"),this.commitProperty(\"timeExtent\");const e=this.layer;return e&&(e.commitProperty(\"dpi\"),e.commitProperty(\"imageFormat\"),e.commitProperty(\"imageTransparency\"),e.commitProperty(\"gdbVersion\")),(this._get(\"version\")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const r=this.layer.sublayers,s=r=>{const t=this.scale,i=0===t,o=0===r.minScale||t<=r.minScale,a=0===r.maxScale||t>=r.maxScale;r.visible&&(i||o&&a)&&(r.sublayers?r.sublayers.forEach(s):e.unshift(r))};r&&r.forEach(s);const t=this._get(\"visibleSublayers\");return!t||t.length!==e.length||t.some(((r,s)=>e[s]!==r))?e:t}toJSON(){const e=this.layer;let r={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?r.dynamicLayers=this.dynamicLayers:r={...r,layers:this.layers,layerDefs:this.layerDefs},r}};e([i({readOnly:!0})],m.prototype,\"dynamicLayers\",null),e([i()],m.prototype,\"floors\",void 0),e([i({readOnly:!0})],m.prototype,\"hasDynamicLayers\",null),e([i()],m.prototype,\"layer\",null),e([i({readOnly:!0})],m.prototype,\"layers\",null),e([i({readOnly:!0})],m.prototype,\"layerDefs\",null),e([i({type:Number})],m.prototype,\"scale\",void 0),e([i(a)],m.prototype,\"timeExtent\",void 0),e([i({readOnly:!0})],m.prototype,\"version\",null),e([i({readOnly:!0})],m.prototype,\"visibleSublayers\",null),m=e([o(\"esri.layers.mixins.ExportImageParameters\")],m);export{m as ExportImageParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import e from\"../../../core/Logger.js\";import{isAbortError as i}from\"../../../core/promiseUtils.js\";import{watch as r}from\"../../../core/reactiveUtils.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{GraphicsCollection as h}from\"../../../support/GraphicsCollection.js\";import{BitmapContainer as o}from\"../engine/BitmapContainer.js\";import{LayerView2DMixin as p}from\"./LayerView2D.js\";import g from\"./graphics/GraphicsView2D.js\";import n from\"./graphics/HighlightGraphicContainer.js\";import l from\"./support/ExportStrategy.js\";import m from\"../../layers/LayerView.js\";import c from\"../../layers/MapImageLayerView.js\";import d from\"../../layers/RefreshableLayerView.js\";import{MapServiceLayerViewHelper as u}from\"../../layers/support/MapServiceLayerViewHelper.js\";import{createQueryGeometry as y}from\"../../support/drapedUtils.js\";let f=class extends(c(d(p(m)))){constructor(){super(...arguments),this._highlightGraphics=new h,this._updateHash=\"\"}fetchPopupFeatures(t,e){return this._popupHighlightHelper.fetchPopupFeatures(t,e)}update(t){const r=`${this.exportImageVersion}/${t.state.id}/${t.pixelRatio}/${t.stationary}`;this._updateHash!==r&&(this._updateHash=r,this.strategy.update(t).catch((t=>{i(t)||e.getLogger(this).error(t)})),t.stationary&&this._popupHighlightHelper.updateHighlightedFeatures(t.state.resolution)),this._highlightView.processUpdate(t)}attach(){const{imageMaxWidth:t,imageMaxHeight:e,version:i}=this.layer,s=i>=10.3,a=i>=10;this._bitmapContainer=new o,this.container.addChild(this._bitmapContainer),this._highlightView=new g({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new n(this.view.featuresTilingScheme),defaultPointSymbolEnabled:!1}),this.container.addChild(this._highlightView.container),this._popupHighlightHelper=new u({createFetchPopupFeaturesQueryGeometry:(t,e)=>y(t,e,this.view),highlightGraphics:this._highlightGraphics,highlightGraphicUpdated:(t,e)=>{this._highlightView.graphicUpdateHandler({graphic:t,property:e})},layerView:this,updatingHandles:this.updatingHandles}),this.strategy=new l({container:this._bitmapContainer,fetchSource:this.fetchImageBitmap.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:t,imageMaxHeight:e,imageRotationSupported:s,imageNormalizationSupported:a,hidpi:!0}),this.addAttachHandles(r((()=>this.exportImageVersion),(()=>this.requestUpdate()))),this.requestUpdate()}detach(){this.strategy.destroy(),this.container.removeAllChildren(),this._bitmapContainer.removeAllChildren(),this._highlightView.destroy(),this._popupHighlightHelper.destroy()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}supportsSpatialReference(t){return this.layer.serviceSupportsSpatialReference(t)}async doRefresh(){this._updateHash=\"\",this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(t,e,i,r){return this.layer.fetchImage(t,e,i,{timeExtent:this.timeExtent,floors:this.floors,...r})}fetchImageBitmap(t,e,i,r){return this.layer.fetchImageBitmap(t,e,i,{timeExtent:this.timeExtent,floors:this.floors,...r})}highlight(t){return this._popupHighlightHelper.highlight(t)}};t([s()],f.prototype,\"strategy\",void 0),t([s()],f.prototype,\"updating\",void 0),f=t([a(\"esri.views.2d.layers.MapImageLayerView2D\")],f);const w=f;export{w as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as o}from\"../../layers/support/commonProperties.js\";import{ExportImageParameters as s}from\"../../layers/support/ExportImageParameters.js\";const p=p=>{let a=class extends p{initialize(){this.exportImageParameters=new s({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get floors(){return this.view?.floors??null}get exportImageVersion(){return this.exportImageParameters?.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),this.commitProperty(\"floors\"),(this._get(\"exportImageVersion\")||0)+1}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return e([r()],a.prototype,\"exportImageParameters\",void 0),e([r({readOnly:!0})],a.prototype,\"floors\",null),e([r({readOnly:!0})],a.prototype,\"exportImageVersion\",null),e([r()],a.prototype,\"layer\",void 0),e([r()],a.prototype,\"suspended\",void 0),e([r(o)],a.prototype,\"timeExtent\",void 0),a=e([t(\"esri.views.layers.MapImageLayerView\")],a),a};export{p as default};\n"],"names":["y","visible","definitionExpression","labelingInfo","labelsVisible","opacity","minScale","maxScale","renderer","source","m","_s","_inherits","_super","_createSuper","e","_this","_classCallCheck","call","floors","scale","_createClass","key","value","this","layer","get","_this2","hasDynamicLayers","visibleSublayers","map","r","l","toExportImageJSON","length","JSON","stringify","n","serviceSublayers","gdbVersion","set","_this3","_get","_set","handles","remove","add","allSublayers","on","notifyChange","propertyName","id","join","_this$floors","_this4","filter","floorInfo","reduce","s","i","t","commitProperty","_this5","sublayers","forEach","o","a","unshift","some","dpi","format","imageFormat","transparent","imageTransparency","dynamicLayers","_objectSpread","layers","layerDefs","readOnly","prototype","type","Number","f","_c","apply","arguments","_highlightGraphics","h","_updateHash","_popupHighlightHelper","fetchPopupFeatures","concat","exportImageVersion","state","pixelRatio","stationary","strategy","update","catch","getLogger","error","updateHighlightedFeatures","resolution","_highlightView","processUpdate","_this$layer","imageMaxWidth","imageMaxHeight","version","_bitmapContainer","container","addChild","g","view","graphics","requestUpdateCallback","requestUpdate","featuresTilingScheme","defaultPointSymbolEnabled","u","createFetchPopupFeaturesQueryGeometry","highlightGraphics","highlightGraphicUpdated","graphicUpdateHandler","graphic","property","layerView","updatingHandles","fetchSource","fetchImageBitmap","bind","imageRotationSupported","imageNormalizationSupported","hidpi","addAttachHandles","destroy","removeAllChildren","serviceSupportsSpatialReference","_doRefresh","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","stop","updating","updateRequested","fetchImage","timeExtent","highlight","p","_p","exportImageParameters","_this$view$floors","_this$view","_this$exportImagePara","_this$timeExtent","_getPrototypeOf","isEmpty","c","d","w"],"sourceRoot":""}